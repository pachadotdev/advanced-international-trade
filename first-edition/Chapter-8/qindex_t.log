----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  Z:\home\pacha\github\advanced-international-trade\first-edition\Chapt
> er-8\qindex_t.log
  log type:  text
 opened on:  20 Jun 2024, 03:18:06

. 
. use Z:\home\pacha\github\advanced-international-trade\first-edition\Chapter-8\qu
> ality_t,clear

. keep year model type quality quan_t

. ren quan_t quan

. 
. preserve

. keep if year==80
(65 observations deleted)

. keep model type quality quan

. ren quality quality_80

. ren quan quan_80

. sort model

. save Z:\home\pacha\github\advanced-international-trade\first-edition\Chapter-8\q
> uality_80_t,replace
file Z:\home\pacha\github\advanced-international-trade\first-edition\Chapter-8\qua
> lity_80_t.dta saved

. restore

. 
. sort model

. merge model using Z:\home\pacha\github\advanced-international-trade\first-editio
> n\Chapter-8\quality_80_t
(note: you are using old merge syntax; see [R] merge for new syntax)
variable model does not uniquely identify observations in the master data

. keep if _merge==3
(14 observations deleted)

. drop _merge

. 
. sort year model

. egen value_80=sum(quality_80*quan_80), by(year)

. egen value_cp=sum(quality*quan_80), by(year)

. gen lasp=value_cp/value_80

. 
. egen value_c=sum(quality*quan),by(year)

. egen value_cq=sum(quality_80*quan), by(year)

. gen pasp=value_c/value_cq

. 
. gen qindex=(lasp*pasp)^0.5

. collapse (mean) qindex, by(year)

. 
. list

     +-----------------+
     | year     qindex |
     |-----------------|
  1. |   79   .9956951 |
  2. |   80          1 |
  3. |   81   1.035043 |
  4. |   82   1.058717 |
  5. |   83   1.057227 |
     |-----------------|
  6. |   84   1.053449 |
  7. |   85   1.160353 |
     +-----------------+

. log close
      name:  <unnamed>
       log:  Z:\home\pacha\github\advanced-international-trade\first-edition\Chapt
> er-8\qindex_t.log
  log type:  text
 closed on:  20 Jun 2024, 03:18:06
----------------------------------------------------------------------------------
