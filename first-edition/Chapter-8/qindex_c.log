----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  Z:\home\pacha\github\advanced-international-trade\first-edition\Chapt
> er-8\qindex_c.log
  log type:  text
 opened on:  20 Jun 2024, 03:21:02

. 
. use Z:\home\pacha\github\advanced-international-trade\first-edition\Chapter-8\qu
> ality_c,clear

. keep year model type quality quan_c

. ren quan_c quan

. 
. preserve

. keep if year==80
(155 observations deleted)

. keep model type quality quan

. ren quality quality_80

. ren quan quan_80

. sort model

. save Z:\home\pacha\github\advanced-international-trade\first-edition\Chapter-8\q
> uality_80_c,replace
file Z:\home\pacha\github\advanced-international-trade\first-edition\Chapter-8\qua
> lity_80_c.dta saved

. restore

. 
. sort model

. merge model using Z:\home\pacha\github\advanced-international-trade\first-editio
> n\Chapter-8\quality_80_c
(note: you are using old merge syntax; see [R] merge for new syntax)
variable model does not uniquely identify observations in the master data

. keep if _merge==3
(23 observations deleted)

. drop _merge

. 
. sort year model

. egen value_80=sum(quality_80*quan_80), by(year)

. egen value_cp=sum(quality*quan_80), by(year)

. gen lasp=value_cp/value_80

. 
. egen value_c=sum(quality*quan),by(year)

. egen value_cq=sum(quality_80*quan), by(year)

. gen pasp=value_c/value_cq

. 
. gen qindex=(lasp*pasp)^0.5

. collapse (mean) qindex, by(year)

. 
. list

     +-----------------+
     | year     qindex |
     |-----------------|
  1. |   79    .986878 |
  2. |   80          1 |
  3. |   81   1.085813 |
  4. |   82    1.15183 |
  5. |   83   1.212675 |
     |-----------------|
  6. |   84   1.266379 |
  7. |   85   1.305744 |
     +-----------------+

. log close
      name:  <unnamed>
       log:  Z:\home\pacha\github\advanced-international-trade\first-edition\Chapt
> er-8\qindex_c.log
  log type:  text
 closed on:  20 Jun 2024, 03:21:02
----------------------------------------------------------------------------------
