{
  "hash": "81f00c552a52b1ab9d53a785dc64adbc",
  "result": {
    "markdown": "\n# Chapter 8. Import Quotas and Export Subsidies\n\n## Empirical exercise\n\nThis exercise is to reproduce regression results Feenstra (1988a). To complete the exercise, the files \"car_7990.dta, truck_7990.dta\" should be stored in `Chapter-8`.  \n\n## Documentation\n\nData Description for Feenstra (1988a):\n\n1. `car.dta`: This STATA file contains car’s various characteristics, such as weight (wght), width (wdth), height (hght), horse power (hs), four-wheel (four), transmission (tran), power steering (ps) and air condition (ac) for 1979-1990. It also includes each model’s sales (quan) and price.\n2. `truck.dta`: This STATA file contains truck’s various characteristics, such as weight (wght), width (wdth), height (hght), horse power (hs), four-wheel (four), transmission (tran), power steering (ps) and air condition (ac) for 1979-1990. It also includes each model’s sale (quan) and price, though sales are missing after 1985.\n\n## Exercise 1\n\nRun the programs `pindex_c.do`, `pindex_t.do`, `unit_value.do` to reproduce the price indexes and unit-values for cars and trucks in Table 8.3.  What formula is used for the price indexes, and how does this differ from the unit-values?\n\n### Feenstra's code\n\n#### pindex_c.do\n\n```stata\nclear\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\pindex_c.log,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_7990,clear\nkeep year model type price quan\n\npreserve\nkeep if year==80\nkeep model type price quan\nren price price_80\nren quan quan_80\nsort model\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_80,replace\nrestore\n\nsort model\nmerge model using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_80\nkeep if _merge==3\ndrop _merge\n\nsort year model\negen value_80=sum(price_80*quan_80), by(year)\negen value_cp=sum(price*quan_80),by(year)\ngen lasp=value_cp/value_80\n\negen value_c=sum(price*quan), by(year)\negen value_cq=sum(price_80*quan), by(year)\ngen pasp=value_c/value_cq\n \ngen pindex=(lasp*pasp)^0.5\n\ncollapse (mean) pindex, by(year)\nlist\n\nlog close\n```\n\nOutput:\n\n```stata\n. clear\n\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\pindex_c.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\pindex_c.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\pindex_c.log\n  log type:  text\n opened on:  19 Jun 2024, 18:40:59\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\ca\n> r_7990,clear\n\n. keep year model type price quan\n\n. \n. preserve\n\n. keep if year==80\n(260 observations deleted)\n\n. keep model type price quan\n\n. ren price price_80\n\n. ren quan quan_80\n\n. sort model\n\n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\c\n> ar_80,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car\n> _80.dta saved\n\n. restore\n\n. \n. sort model\n\n. merge model using Z:\\home\\pacha\\github\\advanced-international-trade\\first-editio\n> n\\Chapter-8\\car_80\n(note: you are using old merge syntax; see [R] merge for new syntax)\nvariable model does not uniquely identify observations in the master data\n\n. keep if _merge==3\n(55 observations deleted)\n\n. drop _merge\n\n. \n. sort year model\n\n. egen value_80=sum(price_80*quan_80), by(year)\n\n. egen value_cp=sum(price*quan_80),by(year)\n\n. gen lasp=value_cp/value_80\n\n. \n. egen value_c=sum(price*quan), by(year)\n\n. egen value_cq=sum(price_80*quan), by(year)\n\n. gen pasp=value_c/value_cq\n\n.  \n. gen pindex=(lasp*pasp)^0.5\n\n. \n. collapse (mean) pindex, by(year)\n\n. list\n\n     +-----------------+\n     | year     pindex |\n     |-----------------|\n  1. |   79      .9663 |\n  2. |   80          1 |\n  3. |   81   1.197522 |\n  4. |   82   1.289163 |\n  5. |   83   1.312988 |\n     |-----------------|\n  6. |   84   1.389093 |\n  7. |   85   1.477987 |\n  8. |   86   1.668846 |\n  9. |   87   1.885685 |\n 10. |   88    2.04798 |\n     |-----------------|\n 11. |   89   2.082082 |\n 12. |   90    2.10851 |\n     +-----------------+\n\n. \n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\pindex_c.log\n  log type:  text\n closed on:  19 Jun 2024, 18:41:01\n----------------------------------------------------------------------------------\n\n. \nend of do-file\n```\n\n#### pindex_t.do\n\n```stata\nclear\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\pindex_t.log,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_7990,clear\nkeep year model type price quan\n\npreserve\nkeep if year==80\nkeep model type price quan\nren price price_80\nren quan quan_80\nsort model\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_80,replace\nrestore\n\nsort model\nmerge model using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_80\nkeep if _merge==3\ndrop _merge\n\nsort year model\negen value_80=sum(price_80*quan_80), by(year)\negen value_cp=sum(price*quan_80),by(year)\ngen lasp=value_cp/value_80\n\negen value_c=sum(price*quan), by(year)\negen value_cq=sum(price_80*quan), by(year)\ngen pasp=value_c/value_cq\n \ngen pindex=(lasp*pasp)^0.5\n\ncollapse (mean) pindex, by(year)\nlist\n\nlog close\n```\n\nOutput:\n\n```stata\n. clear\n\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\pindex_t.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\pindex_t.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\pindex_t.log\n  log type:  text\n opened on:  19 Jun 2024, 18:59:29\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tr\n> uck_7990,clear\n\n. keep year model type price quan\n\n. \n. preserve\n\n. keep if year==80\n(110 observations deleted)\n\n. keep model type price quan\n\n. ren price price_80\n\n. ren quan quan_80\n\n. sort model\n\n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\t\n> ruck_80,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tru\n> ck_80.dta saved\n\n. restore\n\n. \n. sort model\n\n. merge model using Z:\\home\\pacha\\github\\advanced-international-trade\\first-editio\n> n\\Chapter-8\\truck_80\n(note: you are using old merge syntax; see [R] merge for new syntax)\nvariable model does not uniquely identify observations in the master data\n\n. keep if _merge==3\n(38 observations deleted)\n\n. drop _merge\n\n. \n. sort year model\n\n. egen value_80=sum(price_80*quan_80), by(year)\n\n. egen value_cp=sum(price*quan_80),by(year)\n\n. gen lasp=value_cp/value_80\n\n. \n. egen value_c=sum(price*quan), by(year)\n\n. egen value_cq=sum(price_80*quan), by(year)\n\n. gen pasp=value_c/value_cq\n(21 missing values generated)\n\n.  \n. gen pindex=(lasp*pasp)^0.5\n(21 missing values generated)\n\n. \n. collapse (mean) pindex, by(year)\n\n. list\n\n     +-----------------+\n     | year     pindex |\n     |-----------------|\n  1. |   79    .970215 |\n  2. |   80          1 |\n  3. |   81   1.278085 |\n  4. |   82   1.309353 |\n  5. |   83   1.210055 |\n     |-----------------|\n  6. |   84   1.230847 |\n  7. |   85   1.252268 |\n  8. |   86          . |\n  9. |   87          . |\n 10. |   88          . |\n     |-----------------|\n 11. |   89          . |\n 12. |   90          . |\n     +-----------------+\n\n. \n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\pindex_t.log\n  log type:  text\n closed on:  19 Jun 2024, 18:59:31\n----------------------------------------------------------------------------------\n\n. \nend of do-file\n```\n\n#### unit_value.do\n\n```stata\nclear\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\unit_value.log,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_7990,clear\n\ngen value=price*quan\negen aquan=mean(quan), by(year)\negen avalue=mean(value), by(year)\ngen uvalue=avalue/aquan\ncollapse (mean) uvalue, by(year)\nlist\nclear\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_7990,clear\ngen value=price*quan\negen aquan=mean(quan), by(year)\negen avalue=mean(value), by(year)\ngen uvalue=avalue/aquan\ncollapse (mean) uvalue, by(year)\nlist\nclear\n\nlog close\nexit\n```\n\nOutput:\n\n```stata\n. clear\n\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\unit_value.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\unit_value.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\unit_value.log\n  log type:  text\n opened on:  19 Jun 2024, 19:13:08\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\ca\n> r_7990,clear\n\n. \n. gen value=price*quan\n\n. egen aquan=mean(quan), by(year)\n\n. egen avalue=mean(value), by(year)\n\n. gen uvalue=avalue/aquan\n\n. collapse (mean) uvalue, by(year)\n\n. list\n\n     +-----------------+\n     | year     uvalue |\n     |-----------------|\n  1. |   79   4945.603 |\n  2. |   80   5174.757 |\n  3. |   81   6210.741 |\n  4. |   82   6834.219 |\n  5. |   83   7069.203 |\n     |-----------------|\n  6. |   84   7518.311 |\n  7. |   85   8153.146 |\n  8. |   86   9391.989 |\n  9. |   87   10396.91 |\n 10. |   88    10840.6 |\n     |-----------------|\n 11. |   89   10492.76 |\n 12. |   90   11112.68 |\n     +-----------------+\n\n. clear\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tr\n> uck_7990,clear\n\n. gen value=price*quan\n\n. egen aquan=mean(quan), by(year)\n\n. egen avalue=mean(value), by(year)\n\n. gen uvalue=avalue/aquan\n(45 missing values generated)\n\n. collapse (mean) uvalue, by(year)\n\n. list\n\n     +-----------------+\n     | year     uvalue |\n     |-----------------|\n  1. |   79   4794.177 |\n  2. |   80   4937.291 |\n  3. |   81   6313.539 |\n  4. |   82   6426.264 |\n  5. |   83   6134.027 |\n     |-----------------|\n  6. |   84   6246.728 |\n  7. |   85   6249.927 |\n  8. |   86          . |\n  9. |   87          . |\n 10. |   88          . |\n     |-----------------|\n 11. |   89          . |\n 12. |   90          . |\n     +-----------------+\n\n. clear\n\n. \n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\unit_value.log\n  log type:  text\n closed on:  19 Jun 2024, 19:13:10\n----------------------------------------------------------------------------------\n\n. exit\n\nend of do-file\n```\n\n### My code\n\n#### pindex_c.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Packages ----\n\nlibrary(archive)\nlibrary(haven)\nlibrary(dplyr)\nlibrary(tidyr)\n\n# Extract ----\n\nfzip <- \"first-edition/Chapter-8.zip\"\ndout <- gsub(\"\\\\.zip$\", \"\", fzip)\n\nif (!dir.exists(dout)) {\n  archive_extract(fzip, dir = dout)\n}\n\n# Read and transform ----\n\nfout <- paste0(dout, \"/feenstra_88.rds\")\n\nif (!file.exists(fout)) {\n  feenstra_88 <- list(\n    car_7990 = read_dta(paste0(dout, \"/car_7990.dta\")),\n    truck_7990 = read_dta(paste0(dout, \"/truck_7990.dta\"))\n  )\n\n  saveRDS(feenstra_88, fout)\n} else {\n  feenstra_88 <- readRDS(fout)\n}\n\ncar_7990 <- feenstra_88$car_7990 %>%\n  select(year, model, type, price, quan) %>%\n  arrange(year, model)\n\ncar_80 <- car_7990 %>%\n  filter(year == 80) %>%\n  select(model, type, price, quan) %>%\n  rename(price_80 = price, quan_80 = quan)\n\ncar_7990 <- car_7990 %>%\n  inner_join(car_80) %>%\n  group_by(year) %>%\n  mutate(\n    value_80 = sum(price_80 * quan_80),\n    value_cp = sum(price * quan_80)\n  ) %>%\n  ungroup() %>%\n  mutate(lasp = value_cp / value_80)\n\ncar_7990 <- car_7990 %>%\n  group_by(year) %>%\n  mutate(\n    value_c = sum(price * quan),\n    value_cq = sum(price_80 * quan)\n  ) %>%\n  ungroup() %>%\n  mutate(pasp = value_c / value_cq)\n\ncar_7990 %>%\n  mutate(pindex = sqrt(lasp * pasp)) %>%\n  group_by(year) %>%\n  summarise(pindex = mean(pindex))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 2\n    year pindex\n   <dbl>  <dbl>\n 1    79  0.966\n 2    80  1    \n 3    81  1.20 \n 4    82  1.29 \n 5    83  1.31 \n 6    84  1.39 \n 7    85  1.48 \n 8    86  1.67 \n 9    87  1.89 \n10    88  2.05 \n11    89  2.08 \n12    90  2.11 \n```\n:::\n:::\n\n\n#### pindex_t.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntruck_7990 <- feenstra_88$truck_7990 %>%\n  select(year, model, type, price, quan) %>%\n  arrange(year, model)\n\ntruck_80 <- truck_7990 %>%\n  filter(year == 80) %>%\n  select(model, type, price, quan) %>%\n  rename(price_80 = price, quan_80 = quan)\n\ntruck_7990 <- truck_7990 %>%\n  inner_join(truck_80) %>%\n  group_by(year) %>%\n  mutate(\n    value_80 = sum(price_80 * quan_80),\n    value_cp = sum(price * quan_80)\n  ) %>%\n  ungroup() %>%\n  mutate(lasp = value_cp / value_80)\n\ntruck_7990 <- truck_7990 %>%\n  group_by(year) %>%\n  mutate(\n    value_c = sum(price * quan),\n    value_cq = sum(price_80 * quan)\n  ) %>%\n  ungroup() %>%\n  mutate(pasp = value_c / value_cq)\n\ntruck_7990 %>%\n  mutate(pindex = sqrt(lasp * pasp)) %>%\n  group_by(year) %>%\n  summarise(pindex = mean(pindex))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 2\n    year  pindex\n   <dbl>   <dbl>\n 1    79   0.970\n 2    80   1    \n 3    81   1.28 \n 4    82   1.31 \n 5    83   1.21 \n 6    84   1.23 \n 7    85   1.25 \n 8    86 NaN    \n 9    87 NaN    \n10    88 NaN    \n11    89 NaN    \n12    90 NaN    \n```\n:::\n:::\n\n\n#### unit_value.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_7990 <- feenstra_88$car_7990 %>%\n  mutate(value = price * quan) %>%\n  group_by(year) %>%\n  mutate(\n    aquan = mean(quan),\n    avalue = mean(value),\n    uvalue = avalue / aquan\n  )\n\ntruck_7990 <- feenstra_88$truck_7990 %>%\n  mutate(value = price * quan) %>%\n  group_by(year) %>%\n  mutate(\n    aquan = mean(quan),\n    avalue = mean(value),\n    uvalue = avalue / aquan\n  )\n\ncar_7990 %>%\n  group_by(year) %>%\n  summarise(uvalue = mean(uvalue))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 2\n    year uvalue\n   <dbl>  <dbl>\n 1    79  4946.\n 2    80  5175.\n 3    81  6211.\n 4    82  6834.\n 5    83  7069.\n 6    84  7518.\n 7    85  8153.\n 8    86  9392.\n 9    87 10397.\n10    88 10841.\n11    89 10493.\n12    90 11113.\n```\n:::\n\n```{.r .cell-code}\ntruck_7990 %>%\n  group_by(year) %>%\n  summarise(uvalue = mean(uvalue))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 2\n    year uvalue\n   <dbl>  <dbl>\n 1    79  4794.\n 2    80  4937.\n 3    81  6314.\n 4    82  6426.\n 5    83  6134.\n 6    84  6247.\n 7    85  6250.\n 8    86   NaN \n 9    87   NaN \n10    88   NaN \n11    89   NaN \n12    90   NaN \n```\n:::\n:::\n\n\n## Exercise 2\n\nRun the program `car_reg.do` to reproduce the column (1) in Table 8.4, and the program `truck_reg.do` to reproduce column (2). What weights are being used in the regression, and how does this affect the results?\n\n### Feenstra's code\n\n#### car_reg.do\n\n```stata\n\nclear\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_reg.log,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_7990,clear\ndrop if year>=86\n\ntab year, gen(yd)\n\nprogram define nlcar\nversion 7.0\nif \"`1'\"==\"?\"{\nglobal S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8\"\nglobal a3=1\nglobal a4=1\nglobal a5=1\nglobal a6=1\nglobal a7=1\nglobal b2=.1\nglobal b3=.1\nglobal b4=.1\nglobal b5=.1\nglobal b6=.1\nglobal b7=.1\nglobal c1=.1\nglobal c2=.1\nglobal c3=.1\nglobal c4=.1\nglobal c5=.1\nglobal c6=.1\nglobal c7=.1\nglobal c8=.1\nexit\n}\nreplace `1'=$a3*yd3+$a4*yd4+$a5*yd5+$a6*yd6+$a7*yd7/*\n*/+exp($b2*yd2+$b3*yd3+$b4*yd4+$b5*yd5+$b6*yd6+$b7*yd7/*\n*/+$c1*wght+$c2*wdth+$c3*hght+$c4*hp+$c5*tran+$c6*ps+$c7*ac+$c8)\n\nend\n\nnl car price\n\ngen winv=1/exp(_b[b2]*yd2+_b[b3]*yd3+_b[b4]*yd4+_b[b5]*yd5+_b[b6]*yd6+_b[b7]*yd7/*\n*/+_b[c1]*wght+_b[c2]*wdth+_b[c3]*hght+_b[c4]*hp+_b[c5]*tran+_b[c6]*ps+_b[c7]*ac+_b[c8])\n\ngen nprice=price*winv\ngen nyd3=yd3*winv\ngen nyd4=yd4*winv\ngen nyd5=yd5*winv\ngen nyd6=yd6*winv\ngen nyd7=yd7*winv\n\nprogram define nlncar\n\tversion 7.0\n\tif \"`1'\"==\"?\"{\n\t\tglobal S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8\"\n\t\tglobal a3=1\n\t\tglobal a4=1\n\t\tglobal a5=1\t\n\t\tglobal a6=1\n\t\tglobal a7=1\n\t\tglobal b2=.1\t\n\t\tglobal b3=.1\n\t\tglobal b4=.1\n\t\tglobal b5=.1\n\t\tglobal b6=.1\t\n\t\tglobal b7=.1\n\t\tglobal c1=.1\n\t\tglobal c2=.1\n\t\tglobal c3=.1\n\t\tglobal c4=.1\n\t\tglobal c5=.1\n\t\tglobal c6=.1\n\t\tglobal c7=.1\n\t\tglobal c8=.1\n\t\texit\n\t}\n\treplace `1'=$a3*nyd3+$a4*nyd4+$a5*nyd5+$a6*nyd6+$a7*nyd7/*\n*/+winv*exp($b2*yd2+$b3*yd3+$b4*yd4+$b5*yd5+$b6*yd6+$b7*yd7/*\n*/+$c1*wght+$c2*wdth+$c3*hght+$c4*hp+$c5*tran+$c6*ps+$c7*ac+$c8)\n\nend\n\nnl ncar nprice\nclear\nprogram drop _all\nlog close\nexit\n```\n\nOutput:\n\n```stata\n. clear\n\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\car_reg.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\car_reg.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\car_reg.log\n  log type:  text\n opened on:  19 Jun 2024, 19:28:58\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\ca\n> r_7990,clear\n\n. drop if year>=86\n(105 observations deleted)\n\n. \n. tab year, gen(yd)\n\n       year |      Freq.     Percent        Cum.\n------------+-----------------------------------\n         79 |         21       11.73       11.73\n         80 |         24       13.41       25.14\n         81 |         24       13.41       38.55\n         82 |         24       13.41       51.96\n         83 |         26       14.53       66.48\n         84 |         29       16.20       82.68\n         85 |         31       17.32      100.00\n------------+-----------------------------------\n      Total |        179      100.00\n\n. \n. program define nlcar\n  1. version 7.0\n  2. if \"`1'\"==\"?\"{\n  3. global S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8\"\n  4. global a3=1\n  5. global a4=1\n  6. global a5=1\n  7. global a6=1\n  8. global a7=1\n  9. global b2=.1\n 10. global b3=.1\n 11. global b4=.1\n 12. global b5=.1\n 13. global b6=.1\n 14. global b7=.1\n 15. global c1=.1\n 16. global c2=.1\n 17. global c3=.1\n 18. global c4=.1\n 19. global c5=.1\n 20. global c6=.1\n 21. global c7=.1\n 22. global c8=.1\n 23. exit\n 24. }\n 25. replace `1'=$a3*yd3+$a4*yd4+$a5*yd5+$a6*yd6+$a7*yd7/*\n> */+exp($b2*yd2+$b3*yd3+$b4*yd4+$b5*yd5+$b6*yd6+$b7*yd7/*\n> */+$c1*wght+$c2*wdth+$c3*hght+$c4*hp+$c5*tran+$c6*ps+$c7*ac+$c8)\n 26. \n. end\n\n. \n. nl car price\n(obs = 179)\n\nIteration 0:   residual SS =  1.16e+10\n...\nIteration 9:   residual SS =  8.39e+07\nIteration 10:  residual SS =  8.39e+07\n\n      Source |       SS       df       MS            Number of obs =       179\n-------------+------------------------------         F( 19,   160) =   1158.52\n       Model |  1.1541e+10    19   607414473         Prob > F      =    0.0000\n    Residual |    83888568   160   524303.55         R-squared     =    0.9928\n-------------+------------------------------         Adj R-squared =    0.9919\n       Total |  1.1625e+10   179  64942813.2         Root MSE      =  724.0881\n                                                     Res. dev.     =  2845.293\n(car)\n------------------------------------------------------------------------------\n       price |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |  -294.7452   723.3322    -0.41   0.684    -1723.255    1133.765\n          a4 |  -304.9631   714.5517    -0.43   0.670    -1716.132    1106.206\n          a5 |  -137.3977   700.8446    -0.20   0.845    -1521.497    1246.701\n          a6 |   72.87527   695.4052     0.10   0.917    -1300.482    1446.232\n          a7 |  -103.4007   742.9475    -0.14   0.889    -1570.649    1363.848\n          b2 |   .0099678   .0362994     0.27   0.784      -.06172    .0816555\n          b3 |   .1522578   .1022847     1.49   0.139    -.0497444      .35426\n          b4 |   .1899382   .0965319     1.97   0.051    -.0007027    .3805792\n          b5 |   .1540892   .0959124     1.61   0.110    -.0353283    .3435068\n          b6 |    .172972   .0944704     1.83   0.069    -.0135977    .3595417\n          b7 |   .2274326   .0945034     2.41   0.017     .0407977    .4140675\n          c1 |  -.0007315   .1021984    -0.01   0.994    -.2025632    .2011002\n          c2 |   .3681958   .1019742     3.61   0.000     .1668067    .5695849\n          c3 |  -.1431584   .0519385    -2.76   0.007    -.2457317    -.040585\n          c4 |   .6070451   .0665196     9.13   0.000     .4756756    .7384147\n          c5 |   .1315757   .0264479     4.97   0.000     .0793437    .1838078\n          c6 |   .0515819   .0218212     2.36   0.019     .0084872    .0946766\n          c7 |   .1635465   .0228493     7.16   0.000     .1184213    .2086717\n          c8 |    6.73024   .5719055    11.77   0.000     5.600783    7.859697\n------------------------------------------------------------------------------\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. \n. gen winv=1/exp(_b[b2]*yd2+_b[b3]*yd3+_b[b4]*yd4+_b[b5]*yd5+_b[b6]*yd6+_b[b7]*yd7\n> /*\n> */+_b[c1]*wght+_b[c2]*wdth+_b[c3]*hght+_b[c4]*hp+_b[c5]*tran+_b[c6]*ps+_b[c7]*ac\n> +_b[c8])\n\n. \n. gen nprice=price*winv\n\n. gen nyd3=yd3*winv\n\n. gen nyd4=yd4*winv\n\n. gen nyd5=yd5*winv\n\n. gen nyd6=yd6*winv\n\n. gen nyd7=yd7*winv\n\n. \n. program define nlncar\n  1.         version 7.0\n  2.         if \"`1'\"==\"?\"{\n  3.                 global S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c\n> 6 c7 c8\"\n  4.                 global a3=1\n  5.                 global a4=1\n  6.                 global a5=1     \n  7.                 global a6=1\n  8.                 global a7=1\n  9.                 global b2=.1    \n 10.                 global b3=.1\n 11.                 global b4=.1\n 12.                 global b5=.1\n 13.                 global b6=.1    \n 14.                 global b7=.1\n 15.                 global c1=.1\n 16.                 global c2=.1\n 17.                 global c3=.1\n 18.                 global c4=.1\n 19.                 global c5=.1\n 20.                 global c6=.1\n 21.                 global c7=.1\n 22.                 global c8=.1\n 23.                 exit\n 24.         }\n 25.         replace `1'=$a3*nyd3+$a4*nyd4+$a5*nyd5+$a6*nyd6+$a7*nyd7/*\n> */+winv*exp($b2*yd2+$b3*yd3+$b4*yd4+$b5*yd5+$b6*yd6+$b7*yd7/*\n> */+$c1*wght+$c2*wdth+$c3*hght+$c4*hp+$c5*tran+$c6*ps+$c7*ac+$c8)\n 26. \n. end\n\n. \n. nl ncar nprice\n(obs = 179)\n\nIteration 0:   residual SS =  174.4452\n...\nIteration 13:  residual SS =  1.672068\nIteration 14:  residual SS =  1.672068\n\n      Source |       SS       df       MS            Number of obs =       179\n-------------+------------------------------         F( 19,   160) =    871.41\n       Model |  173.025768    19  9.10661939         Prob > F      =    0.0000\n    Residual |  1.67206775   160  .010450423         R-squared     =    0.9904\n-------------+------------------------------         Adj R-squared =    0.9893\n       Total |  174.697836   179  .975965565         Root MSE      =  .1022273\n                                                     Res. dev.     = -328.5451\n(ncar)\n------------------------------------------------------------------------------\n      nprice |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |   410.4256   619.1744     0.66   0.508    -812.3829    1633.234\n          a4 |    378.927   650.2562     0.58   0.561     -905.265    1663.119\n          a5 |   770.6115   601.2054     1.28   0.202    -416.7099    1957.933\n          a6 |   624.3817   618.9925     1.01   0.315    -598.0676    1846.831\n          a7 |  -122.9148   719.4492    -0.17   0.865    -1543.756    1297.927\n          b2 |   .0089535   .0309918     0.29   0.773    -.0522522    .0701592\n          b3 |   .0474345   .1093808     0.43   0.665    -.1685818    .2634509\n          b4 |   .0938457    .108274     0.87   0.387    -.1199848    .3076761\n          b5 |   .0195742   .1052628     0.19   0.853    -.1883094    .2274579\n          b6 |   .0918745   .1019572     0.90   0.369     -.109481      .29323\n          b7 |   .2189293   .1012639     2.16   0.032      .018943    .4189156\n          c1 |   .0254744   .1207686     0.21   0.833    -.2130317    .2639805\n          c2 |   .3565755   .1083292     3.29   0.001      .142636     .570515\n          c3 |  -.0630705   .0554954    -1.14   0.257    -.1726685    .0465275\n          c4 |   .6899452   .0852231     8.10   0.000      .521638    .8582524\n          c5 |   .1428588   .0244762     5.84   0.000     .0945207    .1911968\n          c6 |   .0581011   .0272835     2.13   0.035     .0042188    .1119834\n          c7 |   .1473354    .033027     4.46   0.000     .0821103    .2125606\n          c8 |   6.328371   .5830815    10.85   0.000     5.176842    7.479899\n------------------------------------------------------------------------------\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. clear\n\n. program drop _all\n\n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\car_reg.log\n  log type:  text\n closed on:  19 Jun 2024, 19:29:06\n----------------------------------------------------------------------------------\n\n. exit\n\nend of do-file\n```\n\n### My code\n\n#### truck_reg.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(minpack.lm) # for nlsLM()\n\ncar_7990 <- feenstra_88$car_7990 %>%\n  filter(year < 86) %>%\n  mutate(yd = factor(year)) %>%\n  group_by(yd) %>%\n  mutate(id = row_number()) %>%\n  ungroup()\n\ncar_7990 %>%\n  group_by(yd) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  mutate(\n    percent = freq / sum(freq) * 100,\n    cum = cumsum(percent)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 4\n  yd     freq percent   cum\n  <fct> <int>   <dbl> <dbl>\n1 79       21    11.7  11.7\n2 80       24    13.4  25.1\n3 81       24    13.4  38.5\n4 82       24    13.4  52.0\n5 83       26    14.5  66.5\n6 84       29    16.2  82.7\n7 85       31    17.3 100  \n```\n:::\n\n```{.r .cell-code}\n# expand the yd variable to 0/1 columns\n# in R, you cannot multiply a factor/categorical variable\n\ncar_7990 <- car_7990 %>%\n  mutate(yd_ind = as.integer(yd)) %>%\n  mutate(yd_ind = as.factor(yd_ind - min(yd_ind) + 1))\n\ncar_7990_dummy <- model.matrix(~ yd_ind - 1, data = car_7990)\ncolnames(car_7990_dummy) <- gsub(\"_ind\", \"\", colnames(car_7990_dummy))\n\ncar_7990 <- car_7990 %>%\n  bind_cols(as.data.frame(car_7990_dummy))\n\n# fit the non-linear specification with initial values\n# nls() fails, so I use nlsLM() that implements the Levenberg-Marquardt\n# algorithm\n\ninitial_values <- list(\n  a3 = 1, a4 = 1, a5 = 1, a6 = 1, a7 = 1,\n  b2 = 0.1, b3 = 0.1, b4 = 0.1, b5 = 0.1, b6 = 0.1, b7 = 0.1,\n  c1 = 0.1, c2 = 0.1, c3 = 0.1, c4 = 0.1, c5 = 0.1, c6 = 0.1, c7 = 0.1,\n  c8 = 0.1\n)\n\nfit <- nlsLM(\n  price ~ a3 * yd3 + a4 * yd4 + a5 * yd5 + a6 * yd6 + a7 * yd7 +\n    exp(\n      b2 * yd2 + b3 * yd3 + b4 * yd4 + b5 * yd5 + b6 * yd6 + b7 * yd7 +\n        c1 * wght + c2 * wdth + c3 * hght + c4 * hp + c5 * tran + c6 * ps +\n        c7 * ac + c8\n    ),\n  data = car_7990,\n  start = initial_values\n)\n\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: price ~ a3 * yd3 + a4 * yd4 + a5 * yd5 + a6 * yd6 + a7 * yd7 + \n    exp(b2 * yd2 + b3 * yd3 + b4 * yd4 + b5 * yd5 + b6 * yd6 + \n        b7 * yd7 + c1 * wght + c2 * wdth + c3 * hght + c4 * hp + \n        c5 * tran + c6 * ps + c7 * ac + c8)\n\nParameters:\n     Estimate Std. Error t value Pr(>|t|)    \na3 -2.947e+02  7.233e+02  -0.407 0.684236    \na4 -3.049e+02  7.145e+02  -0.427 0.670137    \na5 -1.374e+02  7.008e+02  -0.196 0.844867    \na6  7.293e+01  6.954e+02   0.105 0.916608    \na7 -1.033e+02  7.429e+02  -0.139 0.889554    \nb2  9.967e-03  3.630e-02   0.275 0.783991    \nb3  1.523e-01  1.023e-01   1.489 0.138586    \nb4  1.899e-01  9.653e-02   1.968 0.050842 .  \nb5  1.541e-01  9.591e-02   1.607 0.110130    \nb6  1.730e-01  9.447e-02   1.831 0.068972 .  \nb7  2.274e-01  9.450e-02   2.407 0.017243 *  \nc1 -6.998e-04  1.022e-01  -0.007 0.994545    \nc2  3.682e-01  1.020e-01   3.610 0.000409 ***\nc3 -1.432e-01  5.194e-02  -2.756 0.006522 ** \nc4  6.070e-01  6.652e-02   9.126 2.93e-16 ***\nc5  1.316e-01  2.645e-02   4.975 1.67e-06 ***\nc6  5.158e-02  2.182e-02   2.364 0.019283 *  \nc7  1.635e-01  2.285e-02   7.157 2.81e-11 ***\nc8  6.730e+00  5.719e-01  11.768  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 724.1 on 160 degrees of freedom\n\nNumber of iterations to convergence: 19 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n\n```{.r .cell-code}\nfit_coef <- coef(fit)\n\ncar_7990 <- car_7990 %>%\n  mutate(\n    winv = 1 / exp(fit_coef[\"b2\"] * yd2 + fit_coef[\"b3\"] * yd3 +\n      fit_coef[\"b4\"] * yd4 + fit_coef[\"b5\"] * yd5 + fit_coef[\"b6\"] * yd6 +\n      fit_coef[\"b7\"] * yd7 + fit_coef[\"c1\"] * wght + fit_coef[\"c2\"] * wdth +\n      fit_coef[\"c3\"] * hght + fit_coef[\"c4\"] * hp + fit_coef[\"c5\"] * tran +\n      fit_coef[\"c6\"] * ps + fit_coef[\"c7\"] * ac + fit_coef[\"c8\"]),\n    nprice = price * winv,\n    nyd3 = yd3 * winv,\n    nyd4 = yd4 * winv,\n    nyd5 = yd5 * winv,\n    nyd6 = yd6 * winv,\n    nyd7 = yd7 * winv\n  )\n\nfit2 <- nlsLM(\n  nprice ~ a3 * nyd3 + a4 * nyd4 + a5 * nyd5 + a6 * nyd6 + a7 * nyd7 +\n    winv * exp(\n      b2 * yd2 + b3 * yd3 + b4 * yd4 + b5 * yd5 + b6 * yd6 + b7 * yd7 +\n        c1 * wght + c2 * wdth + c3 * hght + c4 * hp + c5 * tran + c6 * ps +\n        c7 * ac + c8\n    ),\n  data = car_7990,\n  start = initial_values,\n  # increase the number of iterations to avoid convergence issues\n  control = nls.lm.control(maxiter = 100)\n)\n\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: nprice ~ a3 * nyd3 + a4 * nyd4 + a5 * nyd5 + a6 * nyd6 + a7 * \n    nyd7 + winv * exp(b2 * yd2 + b3 * yd3 + b4 * yd4 + b5 * yd5 + \n    b6 * yd6 + b7 * yd7 + c1 * wght + c2 * wdth + c3 * hght + \n    c4 * hp + c5 * tran + c6 * ps + c7 * ac + c8)\n\nParameters:\n     Estimate Std. Error t value Pr(>|t|)    \na3  4.105e+02  6.192e+02   0.663  0.50834    \na4  3.789e+02  6.503e+02   0.583  0.56087    \na5  7.706e+02  6.012e+02   1.282  0.20176    \na6  6.244e+02  6.190e+02   1.009  0.31465    \na7 -1.229e+02  7.194e+02  -0.171  0.86455    \nb2  8.954e-03  3.099e-02   0.289  0.77303    \nb3  4.743e-02  1.094e-01   0.434  0.66515    \nb4  9.384e-02  1.083e-01   0.867  0.38740    \nb5  1.957e-02  1.053e-01   0.186  0.85274    \nb6  9.188e-02  1.020e-01   0.901  0.36887    \nb7  2.189e-01  1.013e-01   2.162  0.03211 *  \nc1  2.548e-02  1.208e-01   0.211  0.83316    \nc2  3.566e-01  1.083e-01   3.292  0.00123 ** \nc3 -6.306e-02  5.550e-02  -1.136  0.25748    \nc4  6.899e-01  8.522e-02   8.096 1.36e-13 ***\nc5  1.429e-01  2.448e-02   5.837 2.88e-08 ***\nc6  5.810e-02  2.728e-02   2.130  0.03474 *  \nc7  1.473e-01  3.303e-02   4.461 1.53e-05 ***\nc8  6.328e+00  5.831e-01  10.853  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1022 on 160 degrees of freedom\n\nNumber of iterations to convergence: 18 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n:::\n\n\n## Exercise 3\n\nPooling car and truck data, run `system_7985.do` to reproduce columns (3) and (4) in Table 8.4 with the constraints specified in equation (8.22). How are these constraints built into the program for the nonlinear regression?\n\n### Feenstra's code\n\n```stata\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\system_7985.log,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_7990,clear\ngen ve=2\nrename wdth wdth_t\nrename hght hght_t\nrename weight wght_t\nrename hp hp_t\nrename four four_t\nrename tran tran_t\nrename ps ps_t\nrename ac ac_t\ndrop if year>=86\n\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_temp,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_7990,clear\ndrop if year>=86\ngen ve=1\nrename wdth wdth_c\nrename hght hght_c\nrename wght wght_c\nrename hp hp_c\nrename four four_c\nrename tran tran_c\nrename ps ps_c\nrename ac ac_c\n\nappend using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_temp\n\nreplace wdth_c=0 if wdth_c==.\nreplace hght_c=0 if hght_c==.\nreplace wght_c=0 if wght_c==.\nreplace hp_c=0 if hp_c==.\nreplace four_c=0 if four_c==.\nreplace tran_c=0 if tran_c==.\nreplace ps_c=0 if ps_c==.\nreplace ac_c=0 if ac_c==.\nreplace wdth_t=0 if wdth_t==.\nreplace hght_t=0 if hght_t==.\nreplace wght_t=0 if wght_t==.\nreplace hp_t=0 if hp_t==.\nreplace four_t=0 if four_t==.\nreplace tran_t=0 if tran_t==.\nreplace ps_t=0 if ps_t==.\nreplace ac_t=0 if ac_t==.\n\ntab year, gen(yd)\n\ngen cyd2=yd2\ngen tyd2=yd2\nreplace cyd2=0 if type==\"JT\"\nreplace tyd2=0 if type~=\"JT\"\n\ngen cyd3=yd3\ngen tyd3=yd3\nreplace cyd3=0 if type==\"JT\"\nreplace tyd3=0 if type~=\"JT\"\n\ngen cyd4=yd4\ngen tyd4=yd4\nreplace cyd4=0 if type==\"JT\"\nreplace tyd4=0 if type~=\"JT\"\n\ngen cyd5=yd5\ngen tyd5=yd5\nreplace cyd5=0 if type==\"JT\"\nreplace tyd5=0 if type~=\"JT\"\n\ngen cyd6=yd6\ngen tyd6=yd6\nreplace cyd6=0 if type==\"JT\"\nreplace tyd6=0 if type~=\"JT\"\n\ngen cyd7=yd7\ngen tyd7=yd7\nreplace cyd7=0 if type==\"JT\"\nreplace tyd7=0 if type~=\"JT\"\n\nprogram define nlct_1\nversion 7.0\nif \"`1'\"==\"?\"{\nglobal S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2 d3 d4 d5 d6 d7 d8\"\nglobal a3=1\nglobal a4=1\nglobal a5=1\nglobal a6=1\nglobal a7=1\nglobal b2=.1\nglobal b3=.1\nglobal b4=.1\nglobal b5=.1\nglobal b6=.1\nglobal b7=.1\nglobal c1=.1\nglobal c2=.1\nglobal c3=.1\nglobal c4=.1\nglobal c5=.1\nglobal c6=.1\nglobal c7=.1\nglobal c8=.1\nglobal c9=.1\nglobal d1=.1\nglobal d2=.1\nglobal d3=.1\nglobal d4=.1\nglobal d5=.1\nglobal d6=.1\nglobal d7=.1\nglobal d8=.1\nexit\n}\n\nreplace `1'=$a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n*/+exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n*/+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n*/+$c8)+exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)*tyd6+$c9*tyd7/*\n*/+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n\nend\n\nnl ct_1 price\n\ngen winv=1/exp(_b[b2]*cyd2+_b[b3]*cyd3+_b[b4]*cyd4+_b[b5]*cyd5+_b[b6]*cyd6+_b[b7]*cyd7/*\n*/+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*hp_c+_b[c5]*tran_c+_b[c6]*ps_c/*\n*/+_b[c7]*ac_c+_b[c8])\n\nreplace winv=1/exp((_b[b2]+0.16)*tyd2+(_b[b3]+.16)*tyd3+(_b[b4]+.16)*tyd4/*\n*/+(_b[b5]+.16)*tyd5+(_b[b6]+.16)*tyd6+_b[c9]*tyd7/*\n*/+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*hp_t/*\n*/+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t+_b[d8]) if ve==2\n\ngen nprice=price*winv\n\n\nprogram define nlct_2\nversion 7.0\nif \"`1'\"==\"?\"{\nglobal S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2 d3 d4 d5 d6 d7 d8\"\nglobal a3=1\nglobal a4=1\nglobal a5=1\nglobal a6=1\nglobal a7=1\nglobal b2=.1\nglobal b3=.1\nglobal b4=.1\nglobal b5=.1\nglobal b6=.1\nglobal b7=.1\nglobal c1=.1\nglobal c2=.1\nglobal c3=.1\nglobal c4=.1\nglobal c5=.1\nglobal c6=.1\nglobal c7=.1\nglobal c8=.1\nglobal c9=.1\nglobal d1=.1\nglobal d2=.1\nglobal d3=.1\nglobal d4=.1\nglobal d5=.1\nglobal d6=.1\nglobal d7=.1\nglobal d8=.1\nexit\n}\nreplace `1'=winv*($a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7)/*\n*/+winv*exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n*/+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n*/+$c8)+winv*exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)*tyd6+$c9*tyd7/*\n*/+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n\nend\n\nnl ct_2 nprice\n\nprogram drop _all\nlog close\nexit\n```\n\nOutput:\n\n```stata\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\system_7985.log,replace\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\system_7985.log\n  log type:  text\n opened on:  19 Jun 2024, 21:59:23\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tr\n> uck_7990,clear\n\n. gen ve=2\n\n. rename wdth wdth_t\n\n. rename hght hght_t\n\n. rename weight wght_t\n\n. rename hp hp_t\n\n. rename four four_t\n\n. rename tran tran_t\n\n. rename ps ps_t\n\n. rename ac ac_t\n\n. drop if year>=86\n(45 observations deleted)\n\n. \n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\t\n> ruck_temp,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tru\n> ck_temp.dta saved\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\ca\n> r_7990,clear\n\n. drop if year>=86\n(105 observations deleted)\n\n. gen ve=1\n\n. rename wdth wdth_c\n\n. rename hght hght_c\n\n. rename wght wght_c\n\n. rename hp hp_c\n\n. rename four four_c\n\n. rename tran tran_c\n\n. rename ps ps_c\n\n. rename ac ac_c\n\n. \n. append using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Cha\n> pter-8\\truck_temp\n\n. \n. replace wdth_c=0 if wdth_c==.\n(75 real changes made)\n\n. replace hght_c=0 if hght_c==.\n(75 real changes made)\n\n. replace wght_c=0 if wght_c==.\n(75 real changes made)\n\n. replace hp_c=0 if hp_c==.\n(75 real changes made)\n\n. replace four_c=0 if four_c==.\n(75 real changes made)\n\n. replace tran_c=0 if tran_c==.\n(75 real changes made)\n\n. replace ps_c=0 if ps_c==.\n(75 real changes made)\n\n. replace ac_c=0 if ac_c==.\n(75 real changes made)\n\n. replace wdth_t=0 if wdth_t==.\n(179 real changes made)\n\n. replace hght_t=0 if hght_t==.\n(179 real changes made)\n\n. replace wght_t=0 if wght_t==.\n(179 real changes made)\n\n. replace hp_t=0 if hp_t==.\n(179 real changes made)\n\n. replace four_t=0 if four_t==.\n(179 real changes made)\n\n. replace tran_t=0 if tran_t==.\n(179 real changes made)\n\n. replace ps_t=0 if ps_t==.\n(179 real changes made)\n\n. replace ac_t=0 if ac_t==.\n(179 real changes made)\n\n. \n. tab year, gen(yd)\n\n       year |      Freq.     Percent        Cum.\n------------+-----------------------------------\n         79 |         31       12.20       12.20\n         80 |         34       13.39       25.59\n         81 |         35       13.78       39.37\n         82 |         35       13.78       53.15\n         83 |         36       14.17       67.32\n         84 |         40       15.75       83.07\n         85 |         43       16.93      100.00\n------------+-----------------------------------\n      Total |        254      100.00\n\n. \n. gen cyd2=yd2\n\n. gen tyd2=yd2\n\n. replace cyd2=0 if type==\"JT\"\n(8 real changes made)\n\n. replace tyd2=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd3=yd3\n\n. gen tyd3=yd3\n\n. replace cyd3=0 if type==\"JT\"\n(9 real changes made)\n\n. replace tyd3=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd4=yd4\n\n. gen tyd4=yd4\n\n. replace cyd4=0 if type==\"JT\"\n(9 real changes made)\n\n. replace tyd4=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd5=yd5\n\n. gen tyd5=yd5\n\n. replace cyd5=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd5=0 if type~=\"JT\"\n(29 real changes made)\n\n. \n. gen cyd6=yd6\n\n. gen tyd6=yd6\n\n. replace cyd6=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd6=0 if type~=\"JT\"\n(33 real changes made)\n\n. \n. gen cyd7=yd7\n\n. gen tyd7=yd7\n\n. replace cyd7=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd7=0 if type~=\"JT\"\n(36 real changes made)\n\n. \n. program define nlct_1\n  1. version 7.0\n  2. if \"`1'\"==\"?\"{\n  3. global S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2\n>  d3 d4 d5 d6 d7 d8\"\n  4. global a3=1\n  5. global a4=1\n  6. global a5=1\n  7. global a6=1\n  8. global a7=1\n  9. global b2=.1\n 10. global b3=.1\n 11. global b4=.1\n 12. global b5=.1\n 13. global b6=.1\n 14. global b7=.1\n 15. global c1=.1\n 16. global c2=.1\n 17. global c3=.1\n 18. global c4=.1\n 19. global c5=.1\n 20. global c6=.1\n 21. global c7=.1\n 22. global c8=.1\n 23. global c9=.1\n 24. global d1=.1\n 25. global d2=.1\n 26. global d3=.1\n 27. global d4=.1\n 28. global d5=.1\n 29. global d6=.1\n 30. global d7=.1\n 31. global d8=.1\n 32. exit\n 33. }\n 34. \n. replace `1'=$a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n> */+exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n> */+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n> */+$c8)+exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)*tyd6\n> +$c9*tyd7/*\n> */+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n 35. \n. end\n\n. \n. nl ct_1 price\n(obs = 254)\n\nIteration 0:   residual SS =  1.51e+10\n...\nIteration 24:  residual SS =  1.01e+08\nIteration 25:  residual SS =  1.01e+08\n\n      Source |       SS       df       MS            Number of obs =       254\n-------------+------------------------------         F( 28,   226) =   1210.09\n       Model |  1.5069e+10    28   538194036         Prob > F      =    0.0000\n    Residual |   100515047   226  444756.844         R-squared     =    0.9934\n-------------+------------------------------         Adj R-squared =    0.9926\n       Total |  1.5170e+10   254  59724204.9         Root MSE      =  666.9009\n                                                     Res. dev.     =  3994.496\n(ct_1)\n------------------------------------------------------------------------------\n       price |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |   254.0918   317.1045     0.80   0.424    -370.7678    878.9513\n          a4 |   505.1058   325.6388     1.55   0.122    -136.5708    1146.782\n          a5 |   708.9466   317.3172     2.23   0.026       83.668    1334.225\n          a6 |   1082.054   322.4415     3.36   0.001     446.6773     1717.43\n          a7 |   1063.014   373.9703     2.84   0.005     326.0995    1799.929\n          b2 |   .0040633   .0329008     0.12   0.902    -.0607683    .0688948\n          b3 |   .0756038    .049061     1.54   0.125    -.0210716    .1722792\n          b4 |   .0828575   .0490467     1.69   0.093    -.0137897    .1795048\n          b5 |   .0327776    .050707     0.65   0.519    -.0671415    .1326967\n          b6 |   .0351224   .0514768     0.68   0.496    -.0663135    .1365582\n          b7 |   .0825554   .0557608     1.48   0.140    -.0273221    .1924329\n          c1 |   .0326037   .1117298     0.29   0.771    -.1875618    .2527691\n          c2 |    .385946   .1204171     3.21   0.002     .1486621    .6232299\n          c3 |  -.1929238   .0568197    -3.40   0.001     -.304888   -.0809596\n          c4 |    .715212   .0736084     9.72   0.000     .5701655    .8602585\n          c5 |   .1578585     .03381     4.67   0.000     .0912354    .2244816\n          c6 |   .0641097   .0247061     2.59   0.010     .0154259    .1127934\n          c7 |   .1829447   .0242773     7.54   0.000     .1351059    .2307836\n          c8 |   6.599831   .7305317     9.03   0.000     5.160306    8.039356\n          c9 |   .1171992   .0634238     1.85   0.066    -.0077785    .2421769\n          d1 |   .4917133   .0795807     6.18   0.000     .3348983    .6485283\n          d2 |   .2622177   .1757206     1.49   0.137    -.0840426    .6084779\n          d3 |  -.0451278   .0677055    -0.67   0.506    -.1785426     .088287\n          d4 |   .3030767   .1701249     1.78   0.076    -.0321571    .6383106\n          d5 |   .0397822   .0362731     1.10   0.274    -.0316947     .111259\n          d6 |   .0967659   .0501832     1.93   0.055    -.0021208    .1956526\n          d7 |   .3052359   .0715711     4.26   0.000     .1642038     .446268\n          d8 |   6.299805   .9622249     6.55   0.000     4.403726    8.195885\n------------------------------------------------------------------------------\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. \n. gen winv=1/exp(_b[b2]*cyd2+_b[b3]*cyd3+_b[b4]*cyd4+_b[b5]*cyd5+_b[b6]*cyd6+_b[b7\n> ]*cyd7/*\n> */+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*hp_c+_b[c5]*tran_c+_b[c6]*ps\n> _c/*\n> */+_b[c7]*ac_c+_b[c8])\n\n. \n. replace winv=1/exp((_b[b2]+0.16)*tyd2+(_b[b3]+.16)*tyd3+(_b[b4]+.16)*tyd4/*\n> */+(_b[b5]+.16)*tyd5+(_b[b6]+.16)*tyd6+_b[c9]*tyd7/*\n> */+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*hp_t/*\n> */+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t+_b[d8]) if ve==2\n(75 real changes made)\n\n. \n. gen nprice=price*winv\n\n. \n. \n. program define nlct_2\n  1. version 7.0\n  2. if \"`1'\"==\"?\"{\n  3. global S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2\n>  d3 d4 d5 d6 d7 d8\"\n  4. global a3=1\n  5. global a4=1\n  6. global a5=1\n  7. global a6=1\n  8. global a7=1\n  9. global b2=.1\n 10. global b3=.1\n 11. global b4=.1\n 12. global b5=.1\n 13. global b6=.1\n 14. global b7=.1\n 15. global c1=.1\n 16. global c2=.1\n 17. global c3=.1\n 18. global c4=.1\n 19. global c5=.1\n 20. global c6=.1\n 21. global c7=.1\n 22. global c8=.1\n 23. global c9=.1\n 24. global d1=.1\n 25. global d2=.1\n 26. global d3=.1\n 27. global d4=.1\n 28. global d5=.1\n 29. global d6=.1\n 30. global d7=.1\n 31. global d8=.1\n 32. exit\n 33. }\n 34. replace `1'=winv*($a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7)/*\n> */+winv*exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n> */+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n> */+$c8)+winv*exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)\n> *tyd6+$c9*tyd7/*\n> */+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n 35. \n. end\n\n. \n. nl ct_2 nprice\n(obs = 254)\n\nIteration 0:   residual SS =  353.5865\n...\nIteration 20:  residual SS =  2.957295\nIteration 21:  residual SS =  2.957295\n\n      Source |       SS       df       MS            Number of obs =       254\n-------------+------------------------------         F( 28,   226) =    958.75\n       Model |  351.277591    28  12.5456282         Prob > F      =    0.0000\n    Residual |  2.95729549   226  .013085378         R-squared     =    0.9917\n-------------+------------------------------         Adj R-squared =    0.9906\n       Total |  354.234886   254  1.39462554         Root MSE      =  .1143913\n                                                     Res. dev.     = -410.2562\n(ct_2)\n------------------------------------------------------------------------------\n      nprice |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |   367.9829    239.059     1.54   0.125    -103.0867    839.0525\n          a4 |    600.553   254.2261     2.36   0.019     99.59628     1101.51\n          a5 |   887.9399   243.5428     3.65   0.000     408.0348    1367.845\n          a6 |   1104.433   251.0245     4.40   0.000     609.7847     1599.08\n          a7 |   855.7993   366.2444     2.34   0.020     134.1088     1577.49\n          b2 |   .0130387   .0303131     0.43   0.668    -.0466937    .0727711\n          b3 |   .0674477   .0425176     1.59   0.114     -.016334    .1512294\n          b4 |   .0701234   .0441821     1.59   0.114    -.0169382     .157185\n          b5 |  -.0005627   .0470779    -0.01   0.990    -.0933305    .0922051\n          b6 |   .0179989   .0473905     0.38   0.704    -.0753848    .1113826\n          b7 |   .1007712   .0641587     1.57   0.118    -.0256545    .2271969\n          c1 |   .0492474   .1311096     0.38   0.708    -.2091061     .307601\n          c2 |   .3908689   .1383663     2.82   0.005     .1182159     .663522\n          c3 |  -.0618204   .0611492    -1.01   0.313    -.1823158     .058675\n          c4 |   .8103277   .1038045     7.81   0.000     .6057792    1.014876\n          c5 |   .1779391   .0355273     5.01   0.000     .1079319    .2479463\n          c6 |   .0693687   .0304968     2.27   0.024     .0092743     .129463\n          c7 |   .1567051   .0360384     4.35   0.000     .0856908    .2277193\n          c8 |   5.839036   .8621144     6.77   0.000     4.140226    7.537847\n          c9 |   .1059852   .0550545     1.93   0.055    -.0025007    .2144711\n          d1 |   .4759918   .1172145     4.06   0.000     .2450187    .7069649\n          d2 |   .2120021   .1419991     1.49   0.137    -.0678094    .4918136\n          d3 |  -.0270369    .074052    -0.37   0.715    -.1729575    .1188837\n          d4 |     .24435   .1516866     1.61   0.109    -.0545508    .5432508\n          d5 |   .0530065   .0356148     1.49   0.138     -.017173     .123186\n          d6 |   .0575178   .0639555     0.90   0.369    -.0685076    .1835431\n          d7 |   .2971909   .0566882     5.24   0.000      .185486    .4088959\n          d8 |   6.630805   .7652819     8.66   0.000     5.122804    8.138805\n------------------------------------------------------------------------------\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. \n. program drop _all\n\n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\system_7985.log\n  log type:  text\n closed on:  19 Jun 2024, 21:59:28\n----------------------------------------------------------------------------------\n\n. exit\n\nend of do-file\n```\n\n### My code\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntruck_7990 <- feenstra_88$truck_7990 %>%\n  filter(year < 86) %>%\n  mutate(ve = 2) %>%\n  rename(\n    wdth_t = wdth, hght_t = hght, wght_t = weight, hp_t = hp, four_t = four,\n    tran_t = tran, ps_t = ps, ac_t = ac\n  )\n\ncar_7990 <- feenstra_88$car_7990 %>%\n  filter(year < 86) %>%\n  mutate(ve = 1) %>%\n  rename(\n    wdth_c = wdth, hght_c = hght, wght_c = wght, hp_c = hp, four_c = four,\n    tran_c = tran, ps_c = ps, ac_c = ac\n  )\n\ntruck_7990 <- truck_7990 %>%\n  bind_rows(car_7990) %>%\n  mutate(\n    wdth_c = ifelse(is.na(wdth_c), 0, wdth_c),\n    hght_c = ifelse(is.na(hght_c), 0, hght_c),\n    wght_c = ifelse(is.na(wght_c), 0, wght_c),\n    hp_c = ifelse(is.na(hp_c), 0, hp_c),\n    four_c = ifelse(is.na(four_c), 0, four_c),\n    tran_c = ifelse(is.na(tran_c), 0, tran_c),\n    ps_c = ifelse(is.na(ps_c), 0, ps_c),\n    ac_c = ifelse(is.na(ac_c), 0, ac_c),\n    wdth_t = ifelse(is.na(wdth_t), 0, wdth_t),\n    hght_t = ifelse(is.na(hght_t), 0, hght_t),\n    wght_t = ifelse(is.na(wght_t), 0, wght_t),\n    hp_t = ifelse(is.na(hp_t), 0, hp_t),\n    four_t = ifelse(is.na(four_t), 0, four_t),\n    tran_t = ifelse(is.na(tran_t), 0, tran_t),\n    ps_t = ifelse(is.na(ps_t), 0, ps_t),\n    ac_t = ifelse(is.na(ac_t), 0, ac_t)\n  )\n\ntruck_7990 %>%\n  group_by(year) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  mutate(\n    percent = freq / sum(freq) * 100,\n    cum = cumsum(percent)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 4\n   year  freq percent   cum\n  <dbl> <int>   <dbl> <dbl>\n1    79    31    12.2  12.2\n2    80    34    13.4  25.6\n3    81    35    13.8  39.4\n4    82    35    13.8  53.1\n5    83    36    14.2  67.3\n6    84    40    15.7  83.1\n7    85    43    16.9 100  \n```\n:::\n\n```{.r .cell-code}\n# expand the yd variable\n\ntruck_7990 <- truck_7990 %>%\n  mutate(yd = as.factor(year - min(year) + 1))\n\ntruck_7990_dummy <- model.matrix(~ yd - 1, data = truck_7990)\n\ntruck_7990 <- truck_7990 %>%\n  bind_cols(as.data.frame(truck_7990_dummy))\n\n# generate the cyd and tyd variables\n\ntruck_7990 <- truck_7990 %>%\n  mutate(\n    cyd2 = case_when(type == \"JT\" ~ 0, TRUE ~ yd2),\n    tyd2 = case_when(type != \"JT\" ~ 0, TRUE ~ yd2),\n    cyd3 = case_when(type == \"JT\" ~ 0, TRUE ~ yd3),\n    tyd3 = case_when(type != \"JT\" ~ 0, TRUE ~ yd3),\n    cyd4 = case_when(type == \"JT\" ~ 0, TRUE ~ yd4),\n    tyd4 = case_when(type != \"JT\" ~ 0, TRUE ~ yd4),\n    cyd5 = case_when(type == \"JT\" ~ 0, TRUE ~ yd5),\n    tyd5 = case_when(type != \"JT\" ~ 0, TRUE ~ yd5),\n    cyd6 = case_when(type == \"JT\" ~ 0, TRUE ~ yd6),\n    tyd6 = case_when(type != \"JT\" ~ 0, TRUE ~ yd6),\n    cyd7 = case_when(type == \"JT\" ~ 0, TRUE ~ yd7),\n    tyd7 = case_when(type != \"JT\" ~ 0, TRUE ~ yd7)\n  )\n\n# fit the models\n\ninitial_values <- list(\n  a3 = 1, a4 = 1, a5 = 1, a6 = 1, a7 = 1,\n  b2 = 0.1, b3 = 0.1, b4 = 0.1, b5 = 0.1, b6 = 0.1, b7 = 0.1,\n  c1 = 0.1, c2 = 0.1, c3 = 0.1, c4 = 0.1, c5 = 0.1, c6 = 0.1, c7 = 0.1,\n  c8 = 0.1, c9 = 0.1,\n  d1 = 0.1, d2 = 0.1, d3 = 0.1, d4 = 0.1, d5 = 0.1, d6 = 0.1, d7 = 0.1,\n  d8 = 0.1\n)\n\nfit <- nlsLM(\n  price ~ a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * cyd7 +\n    exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + b6 * cyd6 + b7 * cyd7 +\n      c1 * wght_c + c2 * wdth_c + c3 * hght_c + c4 * hp_c + c5 * tran_c +\n      c6 * ps_c + c7 * ac_c + c8) +\n    exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + (b4 + 0.16) * tyd4 +\n      (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + c9 * tyd7 +\n      d1 * wght_t + d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * tran_t +\n      d6 * ps_t + d7 * four_t + d8),\n  data = truck_7990,\n  start = initial_values\n)\n\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: price ~ a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * \n    cyd7 + exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + \n    b6 * cyd6 + b7 * cyd7 + c1 * wght_c + c2 * wdth_c + c3 * \n    hght_c + c4 * hp_c + c5 * tran_c + c6 * ps_c + c7 * ac_c + \n    c8) + exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + (b4 + 0.16) * \n    tyd4 + (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + c9 * tyd7 + \n    d1 * wght_t + d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * \n    tran_t + d6 * ps_t + d7 * four_t + d8)\n\nParameters:\n     Estimate Std. Error t value Pr(>|t|)    \na3  2.542e+02  3.171e+02   0.802 0.423598    \na4  5.052e+02  3.256e+02   1.552 0.122150    \na5  7.090e+02  3.173e+02   2.235 0.026415 *  \na6  1.082e+03  3.224e+02   3.356 0.000926 ***\na7  1.063e+03  3.739e+02   2.843 0.004876 ** \nb2  4.065e-03  3.290e-02   0.124 0.901779    \nb3  7.559e-02  4.906e-02   1.541 0.124732    \nb4  8.284e-02  4.904e-02   1.689 0.092555 .  \nb5  3.276e-02  5.070e-02   0.646 0.518840    \nb6  3.510e-02  5.147e-02   0.682 0.495934    \nb7  8.254e-02  5.576e-02   1.480 0.140197    \nc1  3.261e-02  1.117e-01   0.292 0.770715    \nc2  3.860e-01  1.204e-01   3.205 0.001545 ** \nc3 -1.929e-01  5.683e-02  -3.395 0.000811 ***\nc4  7.152e-01  7.362e-02   9.715  < 2e-16 ***\nc5  1.579e-01  3.382e-02   4.668 5.21e-06 ***\nc6  6.412e-02  2.471e-02   2.595 0.010082 *  \nc7  1.830e-01  2.428e-02   7.535 1.16e-12 ***\nc8  6.599e+00  7.307e-01   9.032  < 2e-16 ***\nc9  1.172e-01  6.342e-02   1.848 0.065932 .  \nd1  4.917e-01  7.958e-02   6.179 2.97e-09 ***\nd2  2.621e-01  1.757e-01   1.492 0.137107    \nd3 -4.513e-02  6.770e-02  -0.667 0.505752    \nd4  3.031e-01  1.701e-01   1.782 0.076158 .  \nd5  3.978e-02  3.627e-02   1.097 0.273899    \nd6  9.676e-02  5.018e-02   1.928 0.055072 .  \nd7  3.052e-01  7.156e-02   4.265 2.94e-05 ***\nd8  6.300e+00  9.620e-01   6.549 3.85e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 666.9 on 226 degrees of freedom\n\nNumber of iterations to convergence: 30 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n\n```{.r .cell-code}\ntruck_7990 <- truck_7990 %>%\n  mutate(\n    winv = case_when(\n      ve == 1 ~ 1 / exp(coef(fit)[\"b2\"] * cyd2 + coef(fit)[\"b3\"] * cyd3 +\n        coef(fit)[\"b4\"] * cyd4 + coef(fit)[\"b5\"] * cyd5 +\n        coef(fit)[\"b6\"] * cyd6 + coef(fit)[\"b7\"] * cyd7 +\n        coef(fit)[\"c1\"] * wght_c + coef(fit)[\"c2\"] * wdth_c +\n        coef(fit)[\"c3\"] * hght_c + coef(fit)[\"c4\"] * hp_c +\n        coef(fit)[\"c5\"] * tran_c + coef(fit)[\"c6\"] * ps_c +\n        coef(fit)[\"c7\"] * ac_c + coef(fit)[\"c8\"]),\n      ve == 2 ~ 1 / exp((coef(fit)[\"b2\"] + 0.16) * tyd2 +\n        (coef(fit)[\"b3\"] + 0.16) * tyd3 + (coef(fit)[\"b4\"] + 0.16) * tyd4 +\n        (coef(fit)[\"b5\"] + 0.16) * tyd5 + (coef(fit)[\"b6\"] + 0.16) * tyd6 +\n        coef(fit)[\"c9\"] * tyd7 + coef(fit)[\"d1\"] * wght_t +\n        coef(fit)[\"d2\"] * wdth_t + coef(fit)[\"d3\"] * hght_t +\n        coef(fit)[\"d4\"] * hp_t + coef(fit)[\"d5\"] * tran_t +\n        coef(fit)[\"d6\"] * ps_t + coef(fit)[\"d7\"] * four_t +\n        coef(fit)[\"d8\"])\n    ),\n    nprice = price * winv\n  )\n\nfit2 <- nlsLM(\n  nprice ~ winv * (a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * cyd7) +\n    winv * exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + b6 * cyd6 +\n      b7 * cyd7 + c1 * wght_c + c2 * wdth_c + c3 * hght_c + c4 * hp_c +\n      c5 * tran_c + c6 * ps_c + c7 * ac_c + c8) +\n    winv * exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + (b4 + 0.16) * tyd4 +\n      (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + c9 * tyd7 + d1 * wght_t +\n      d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * tran_t + d6 * ps_t +\n      d7 * four_t + d8),\n  data = truck_7990,\n  start = initial_values\n)\n\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: nprice ~ winv * (a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + \n    a7 * cyd7) + winv * exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + \n    b5 * cyd5 + b6 * cyd6 + b7 * cyd7 + c1 * wght_c + c2 * wdth_c + \n    c3 * hght_c + c4 * hp_c + c5 * tran_c + c6 * ps_c + c7 * \n    ac_c + c8) + winv * exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + \n    (b4 + 0.16) * tyd4 + (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + \n    c9 * tyd7 + d1 * wght_t + d2 * wdth_t + d3 * hght_t + d4 * \n    hp_t + d5 * tran_t + d6 * ps_t + d7 * four_t + d8)\n\nParameters:\n     Estimate Std. Error t value Pr(>|t|)    \na3  3.679e+02  2.391e+02   1.539 0.125219    \na4  6.005e+02  2.543e+02   2.362 0.019041 *  \na5  8.879e+02  2.436e+02   3.645 0.000332 ***\na6  1.104e+03  2.511e+02   4.399 1.68e-05 ***\na7  8.556e+02  3.663e+02   2.336 0.020379 *  \nb2  1.304e-02  3.031e-02   0.430 0.667488    \nb3  6.745e-02  4.252e-02   1.586 0.114086    \nb4  7.013e-02  4.419e-02   1.587 0.113886    \nb5 -5.484e-04  4.708e-02  -0.012 0.990718    \nb6  1.801e-02  4.740e-02   0.380 0.704268    \nb7  1.008e-01  6.416e-02   1.571 0.117554    \nc1  4.925e-02  1.311e-01   0.376 0.707523    \nc2  3.908e-01  1.383e-01   2.825 0.005153 ** \nc3 -6.182e-02  6.114e-02  -1.011 0.313088    \nc4  8.103e-01  1.038e-01   7.807 2.17e-13 ***\nc5  1.779e-01  3.552e-02   5.009 1.10e-06 ***\nc6  6.936e-02  3.049e-02   2.275 0.023864 *  \nc7  1.567e-01  3.604e-02   4.348 2.08e-05 ***\nc8  5.839e+00  8.619e-01   6.775 1.07e-10 ***\nc9  1.060e-01  5.506e-02   1.925 0.055494 .  \nd1  4.760e-01  1.172e-01   4.060 6.76e-05 ***\nd2  2.121e-01  1.420e-01   1.493 0.136773    \nd3 -2.704e-02  7.406e-02  -0.365 0.715380    \nd4  2.443e-01  1.517e-01   1.611 0.108659    \nd5  5.301e-02  3.562e-02   1.488 0.138112    \nd6  5.751e-02  6.396e-02   0.899 0.369534    \nd7  2.972e-01  5.670e-02   5.242 3.64e-07 ***\nd8  6.630e+00  7.655e-01   8.661 8.98e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1144 on 226 degrees of freedom\n\nNumber of iterations to convergence: 31 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n:::\n\n\n## Exercise 4\n\nRun the programs `unit_quality.do`, `qindex_c.do`, `qindex_t.do` to reproduce the quality indexes and unit-qualities for cars and trucks in Table 8.3. What formula is used for the quality of each model and the quality indexes, and how does this differ from the unit-quality?\n\n### Feenstra's code\n\n#### unit_quality.do\n\n```stata\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\unit_quality.log,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_7990,clear\ndrop if year>=86\ngen ve=2\nrename quan quan_t\nrename wdth wdth_t\nrename hght hght_t\nrename weight wght_t\nrename hp hp_t\nrename four four_t\nrename tran tran_t\nrename ps ps_t\nrename ac ac_t\n\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_temp,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_7990,clear\ndrop if year>=86\ngen ve=1\nrename quan quan_c\nrename wdth wdth_c\nrename hght hght_c\nrename wght wght_c\nrename hp hp_c\nrename four four_c\nrename tran tran_c\nrename ps ps_c\nrename ac ac_c\n\nappend using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_temp\n\nreplace wdth_c=0 if wdth_c==.\nreplace hght_c=0 if hght_c==.\nreplace wght_c=0 if wght_c==.\nreplace hp_c=0 if hp_c==.\nreplace four_c=0 if four_c==.\nreplace tran_c=0 if tran_c==.\nreplace ps_c=0 if ps_c==.\nreplace ac_c=0 if ac_c==.\nreplace wdth_t=0 if wdth_t==.\nreplace hght_t=0 if hght_t==.\nreplace wght_t=0 if wght_t==.\nreplace hp_t=0 if hp_t==.\nreplace four_t=0 if four_t==.\nreplace tran_t=0 if tran_t==.\nreplace ps_t=0 if ps_t==.\nreplace ac_t=0 if ac_t==.\n\ntab year, gen(yd)\n\ngen cyd2=yd2\ngen tyd2=yd2\nreplace cyd2=0 if type==\"JT\"\nreplace tyd2=0 if type~=\"JT\"\n\ngen cyd3=yd3\ngen tyd3=yd3\nreplace cyd3=0 if type==\"JT\"\nreplace tyd3=0 if type~=\"JT\"\n\ngen cyd4=yd4\ngen tyd4=yd4\nreplace cyd4=0 if type==\"JT\"\nreplace tyd4=0 if type~=\"JT\"\n\ngen cyd5=yd5\ngen tyd5=yd5\nreplace cyd5=0 if type==\"JT\"\nreplace tyd5=0 if type~=\"JT\"\n\ngen cyd6=yd6\ngen tyd6=yd6\nreplace cyd6=0 if type==\"JT\"\nreplace tyd6=0 if type~=\"JT\"\n\ngen cyd7=yd7\ngen tyd7=yd7\nreplace cyd7=0 if type==\"JT\"\nreplace tyd7=0 if type~=\"JT\"\n\nprogram define nlct_1\nversion 7.0\nif \"`1'\"==\"?\"{\nglobal S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2 d3 d4 d5 d6 d7 d8\"\nglobal a3=1\nglobal a4=1\nglobal a5=1\nglobal a6=1\nglobal a7=1\nglobal b2=.1\nglobal b3=.1\nglobal b4=.1\nglobal b5=.1\nglobal b6=.1\nglobal b7=.1\nglobal c1=.1\nglobal c2=.1\nglobal c3=.1\nglobal c4=.1\nglobal c5=.1\nglobal c6=.1\nglobal c7=.1\nglobal c8=.1\nglobal c9=.1\nglobal d1=.1\nglobal d2=.1\nglobal d3=.1\nglobal d4=.1\nglobal d5=.1\nglobal d6=.1\nglobal d7=.1\nglobal d8=.1\nexit\n}\n\nreplace `1'=$a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n*/+exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n*/+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n*/+$c8)+exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)*tyd6+$c9*tyd7/*\n*/+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n\nend\n\nnl ct_1 price\n\ngen winv=1/exp(_b[b2]*cyd2+_b[b3]*cyd3+_b[b4]*cyd4+_b[b5]*cyd5+_b[b6]*cyd6+_b[b7]*cyd7/*\n*/+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*hp_c+_b[c5]*tran_c+_b[c6]*ps_c/*\n*/+_b[c7]*ac_c+_b[c8])\n\nreplace winv=1/exp((_b[b2]+0.16)*tyd2+(_b[b3]+.16)*tyd3+(_b[b4]+.16)*tyd4/*\n*/+(_b[b5]+.16)*tyd5+(_b[b6]+.16)*tyd6+_b[c9]*tyd7/*\n*/+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*hp_t/*\n*/+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t+_b[d8]) if ve==2\n\ngen nprice=price*winv\n\n\nprogram define nlct_2\nversion 7.0\nif \"`1'\"==\"?\"{\nglobal S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2 d3 d4 d5 d6 d7 d8\"\nglobal a3=1\nglobal a4=1\nglobal a5=1\nglobal a6=1\nglobal a7=1\nglobal b2=.1\nglobal b3=.1\nglobal b4=.1\nglobal b5=.1\nglobal b6=.1\nglobal b7=.1\nglobal c1=.1\nglobal c2=.1\nglobal c3=.1\nglobal c4=.1\nglobal c5=.1\nglobal c6=.1\nglobal c7=.1\nglobal c8=.1\nglobal c9=.1\nglobal d1=.1\nglobal d2=.1\nglobal d3=.1\nglobal d4=.1\nglobal d5=.1\nglobal d6=.1\nglobal d7=.1\nglobal d8=.1\nexit\n}\nreplace `1'=winv*($a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7)/*\n*/+winv*exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n*/+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n*/+$c8)+winv*exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)*tyd6+$c9*tyd7/*\n*/+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n\nend\n\nnl ct_2 nprice\n\n\npreserve\nkeep if ve==1\n\ngen quality=exp(_b[c8]+_b[b2]+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*hp_c/*\n*/+_b[c5]*tran_c+_b[c6]*ps_c+_b[c7]*ac_c)\n\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\quality_c,replace\n\ngen nvalue=quality*quan_c\negen aquan=mean(quan_c), by(year)\negen anvalue=mean(nvalue),by(year)\ngen uquality=anvalue/aquan\ncollapse (mean)uquality, by(year)\nlist\nrestore\n\npreserve\nkeep if ve==2\n\ngen quality=exp(_b[d8]+_b[b2]+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*hp_t/*\n*/+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t)\n\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\quality_t,replace\n\ngen nvalue=quality*quan_t\negen aquan=mean(quan_t),by(year)\negen anvalue=mean(nvalue), by(year)\ngen uquality=anvalue/aquan\ncollapse (mean)uquality, by(year)\nlist\nrestore\n\nprogram drop _all\nlog close\nexit\n```\n\nOutput:\n\n```stata\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\unit_quality.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\unit_quality.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\unit_quality.log\n  log type:  text\n opened on:  19 Jun 2024, 23:03:32\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tr\n> uck_7990,clear\n\n. drop if year>=86\n(45 observations deleted)\n\n. gen ve=2\n\n. rename quan quan_t\n\n. rename wdth wdth_t\n\n. rename hght hght_t\n\n. rename weight wght_t\n\n. rename hp hp_t\n\n. rename four four_t\n\n. rename tran tran_t\n\n. rename ps ps_t\n\n. rename ac ac_t\n\n. \n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\t\n> ruck_temp,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tru\n> ck_temp.dta saved\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\ca\n> r_7990,clear\n\n. drop if year>=86\n(105 observations deleted)\n\n. gen ve=1\n\n. rename quan quan_c\n\n. rename wdth wdth_c\n\n. rename hght hght_c\n\n. rename wght wght_c\n\n. rename hp hp_c\n\n. rename four four_c\n\n. rename tran tran_c\n\n. rename ps ps_c\n\n. rename ac ac_c\n\n. \n. append using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Cha\n> pter-8\\truck_temp\n\n. \n. replace wdth_c=0 if wdth_c==.\n(75 real changes made)\n\n. replace hght_c=0 if hght_c==.\n(75 real changes made)\n\n. replace wght_c=0 if wght_c==.\n(75 real changes made)\n\n. replace hp_c=0 if hp_c==.\n(75 real changes made)\n\n. replace four_c=0 if four_c==.\n(75 real changes made)\n\n. replace tran_c=0 if tran_c==.\n(75 real changes made)\n\n. replace ps_c=0 if ps_c==.\n(75 real changes made)\n\n. replace ac_c=0 if ac_c==.\n(75 real changes made)\n\n. replace wdth_t=0 if wdth_t==.\n(179 real changes made)\n\n. replace hght_t=0 if hght_t==.\n(179 real changes made)\n\n. replace wght_t=0 if wght_t==.\n(179 real changes made)\n\n. replace hp_t=0 if hp_t==.\n(179 real changes made)\n\n. replace four_t=0 if four_t==.\n(179 real changes made)\n\n. replace tran_t=0 if tran_t==.\n(179 real changes made)\n\n. replace ps_t=0 if ps_t==.\n(179 real changes made)\n\n. replace ac_t=0 if ac_t==.\n(179 real changes made)\n\n. \n. tab year, gen(yd)\n\n       year |      Freq.     Percent        Cum.\n------------+-----------------------------------\n         79 |         31       12.20       12.20\n         80 |         34       13.39       25.59\n         81 |         35       13.78       39.37\n         82 |         35       13.78       53.15\n         83 |         36       14.17       67.32\n         84 |         40       15.75       83.07\n         85 |         43       16.93      100.00\n------------+-----------------------------------\n      Total |        254      100.00\n\n. \n. gen cyd2=yd2\n\n. gen tyd2=yd2\n\n. replace cyd2=0 if type==\"JT\"\n(8 real changes made)\n\n. replace tyd2=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd3=yd3\n\n. gen tyd3=yd3\n\n. replace cyd3=0 if type==\"JT\"\n(9 real changes made)\n\n. replace tyd3=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd4=yd4\n\n. gen tyd4=yd4\n\n. replace cyd4=0 if type==\"JT\"\n(9 real changes made)\n\n. replace tyd4=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd5=yd5\n\n. gen tyd5=yd5\n\n. replace cyd5=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd5=0 if type~=\"JT\"\n(29 real changes made)\n\n. \n. gen cyd6=yd6\n\n. gen tyd6=yd6\n\n. replace cyd6=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd6=0 if type~=\"JT\"\n(33 real changes made)\n\n. \n. gen cyd7=yd7\n\n. gen tyd7=yd7\n\n. replace cyd7=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd7=0 if type~=\"JT\"\n(36 real changes made)\n\n. \n. program define nlct_1\n  1. version 7.0\n  2. if \"`1'\"==\"?\"{\n  3. global S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2\n>  d3 d4 d5 d6 d7 d8\"\n  4. global a3=1\n  5. global a4=1\n  6. global a5=1\n  7. global a6=1\n  8. global a7=1\n  9. global b2=.1\n 10. global b3=.1\n 11. global b4=.1\n 12. global b5=.1\n 13. global b6=.1\n 14. global b7=.1\n 15. global c1=.1\n 16. global c2=.1\n 17. global c3=.1\n 18. global c4=.1\n 19. global c5=.1\n 20. global c6=.1\n 21. global c7=.1\n 22. global c8=.1\n 23. global c9=.1\n 24. global d1=.1\n 25. global d2=.1\n 26. global d3=.1\n 27. global d4=.1\n 28. global d5=.1\n 29. global d6=.1\n 30. global d7=.1\n 31. global d8=.1\n 32. exit\n 33. }\n 34. \n. replace `1'=$a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n> */+exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n> */+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n> */+$c8)+exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)*tyd6\n> +$c9*tyd7/*\n> */+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n 35. \n. end\n\n. \n. nl ct_1 price\n(obs = 254)\n\nIteration 0:   residual SS =  1.51e+10\n...\nIteration 24:  residual SS =  1.01e+08\nIteration 25:  residual SS =  1.01e+08\n\n      Source |       SS       df       MS            Number of obs =       254\n-------------+------------------------------         F( 28,   226) =   1210.09\n       Model |  1.5069e+10    28   538194036         Prob > F      =    0.0000\n    Residual |   100515047   226  444756.844         R-squared     =    0.9934\n-------------+------------------------------         Adj R-squared =    0.9926\n       Total |  1.5170e+10   254  59724204.9         Root MSE      =  666.9009\n                                                     Res. dev.     =  3994.496\n(ct_1)\n------------------------------------------------------------------------------\n       price |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |   254.0918   317.1045     0.80   0.424    -370.7678    878.9513\n          a4 |   505.1058   325.6388     1.55   0.122    -136.5708    1146.782\n          a5 |   708.9466   317.3172     2.23   0.026       83.668    1334.225\n          a6 |   1082.054   322.4415     3.36   0.001     446.6773     1717.43\n          a7 |   1063.014   373.9703     2.84   0.005     326.0995    1799.929\n          b2 |   .0040633   .0329008     0.12   0.902    -.0607683    .0688948\n          b3 |   .0756038    .049061     1.54   0.125    -.0210716    .1722792\n          b4 |   .0828575   .0490467     1.69   0.093    -.0137897    .1795048\n          b5 |   .0327776    .050707     0.65   0.519    -.0671415    .1326967\n          b6 |   .0351224   .0514768     0.68   0.496    -.0663135    .1365582\n          b7 |   .0825554   .0557608     1.48   0.140    -.0273221    .1924329\n          c1 |   .0326037   .1117298     0.29   0.771    -.1875618    .2527691\n          c2 |    .385946   .1204171     3.21   0.002     .1486621    .6232299\n          c3 |  -.1929238   .0568197    -3.40   0.001     -.304888   -.0809596\n          c4 |    .715212   .0736084     9.72   0.000     .5701655    .8602585\n          c5 |   .1578585     .03381     4.67   0.000     .0912354    .2244816\n          c6 |   .0641097   .0247061     2.59   0.010     .0154259    .1127934\n          c7 |   .1829447   .0242773     7.54   0.000     .1351059    .2307836\n          c8 |   6.599831   .7305317     9.03   0.000     5.160306    8.039356\n          c9 |   .1171992   .0634238     1.85   0.066    -.0077785    .2421769\n          d1 |   .4917133   .0795807     6.18   0.000     .3348983    .6485283\n          d2 |   .2622177   .1757206     1.49   0.137    -.0840426    .6084779\n          d3 |  -.0451278   .0677055    -0.67   0.506    -.1785426     .088287\n          d4 |   .3030767   .1701249     1.78   0.076    -.0321571    .6383106\n          d5 |   .0397822   .0362731     1.10   0.274    -.0316947     .111259\n          d6 |   .0967659   .0501832     1.93   0.055    -.0021208    .1956526\n          d7 |   .3052359   .0715711     4.26   0.000     .1642038     .446268\n          d8 |   6.299805   .9622249     6.55   0.000     4.403726    8.195885\n------------------------------------------------------------------------------\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. \n. gen winv=1/exp(_b[b2]*cyd2+_b[b3]*cyd3+_b[b4]*cyd4+_b[b5]*cyd5+_b[b6]*cyd6+_b[b7\n> ]*cyd7/*\n> */+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*hp_c+_b[c5]*tran_c+_b[c6]*ps\n> _c/*\n> */+_b[c7]*ac_c+_b[c8])\n\n. \n. replace winv=1/exp((_b[b2]+0.16)*tyd2+(_b[b3]+.16)*tyd3+(_b[b4]+.16)*tyd4/*\n> */+(_b[b5]+.16)*tyd5+(_b[b6]+.16)*tyd6+_b[c9]*tyd7/*\n> */+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*hp_t/*\n> */+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t+_b[d8]) if ve==2\n(75 real changes made)\n\n. \n. gen nprice=price*winv\n\n. \n. \n. program define nlct_2\n  1. version 7.0\n  2. if \"`1'\"==\"?\"{\n  3. global S_1 \"a3 a4 a5 a6 a7 b2 b3 b4 b5 b6 b7 c1 c2 c3 c4 c5 c6 c7 c8 c9 d1 d2\n>  d3 d4 d5 d6 d7 d8\"\n  4. global a3=1\n  5. global a4=1\n  6. global a5=1\n  7. global a6=1\n  8. global a7=1\n  9. global b2=.1\n 10. global b3=.1\n 11. global b4=.1\n 12. global b5=.1\n 13. global b6=.1\n 14. global b7=.1\n 15. global c1=.1\n 16. global c2=.1\n 17. global c3=.1\n 18. global c4=.1\n 19. global c5=.1\n 20. global c6=.1\n 21. global c7=.1\n 22. global c8=.1\n 23. global c9=.1\n 24. global d1=.1\n 25. global d2=.1\n 26. global d3=.1\n 27. global d4=.1\n 28. global d5=.1\n 29. global d6=.1\n 30. global d7=.1\n 31. global d8=.1\n 32. exit\n 33. }\n 34. replace `1'=winv*($a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7)/*\n> */+winv*exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n> */+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n> */+$c8)+winv*exp($b2*tyd2+($b3+.16)*tyd3+($b4+.16)*tyd4+($b5+.16)*tyd5+($b6+.16)\n> *tyd6+$c9*tyd7/*\n> */+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n 35. \n. end\n\n. \n. nl ct_2 nprice\n(obs = 254)\n\nIteration 0:   residual SS =  353.5865\n...\nIteration 20:  residual SS =  2.957295\nIteration 21:  residual SS =  2.957295\n\n      Source |       SS       df       MS            Number of obs =       254\n-------------+------------------------------         F( 28,   226) =    958.75\n       Model |  351.277591    28  12.5456282         Prob > F      =    0.0000\n    Residual |  2.95729549   226  .013085378         R-squared     =    0.9917\n-------------+------------------------------         Adj R-squared =    0.9906\n       Total |  354.234886   254  1.39462554         Root MSE      =  .1143913\n                                                     Res. dev.     = -410.2562\n(ct_2)\n------------------------------------------------------------------------------\n      nprice |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |   367.9829    239.059     1.54   0.125    -103.0867    839.0525\n          a4 |    600.553   254.2261     2.36   0.019     99.59628     1101.51\n          a5 |   887.9399   243.5428     3.65   0.000     408.0348    1367.845\n          a6 |   1104.433   251.0245     4.40   0.000     609.7847     1599.08\n          a7 |   855.7993   366.2444     2.34   0.020     134.1088     1577.49\n          b2 |   .0130387   .0303131     0.43   0.668    -.0466937    .0727711\n          b3 |   .0674477   .0425176     1.59   0.114     -.016334    .1512294\n          b4 |   .0701234   .0441821     1.59   0.114    -.0169382     .157185\n          b5 |  -.0005627   .0470779    -0.01   0.990    -.0933305    .0922051\n          b6 |   .0179989   .0473905     0.38   0.704    -.0753848    .1113826\n          b7 |   .1007712   .0641587     1.57   0.118    -.0256545    .2271969\n          c1 |   .0492474   .1311096     0.38   0.708    -.2091061     .307601\n          c2 |   .3908689   .1383663     2.82   0.005     .1182159     .663522\n          c3 |  -.0618204   .0611492    -1.01   0.313    -.1823158     .058675\n          c4 |   .8103277   .1038045     7.81   0.000     .6057792    1.014876\n          c5 |   .1779391   .0355273     5.01   0.000     .1079319    .2479463\n          c6 |   .0693687   .0304968     2.27   0.024     .0092743     .129463\n          c7 |   .1567051   .0360384     4.35   0.000     .0856908    .2277193\n          c8 |   5.839036   .8621144     6.77   0.000     4.140226    7.537847\n          c9 |   .1059852   .0550545     1.93   0.055    -.0025007    .2144711\n          d1 |   .4759918   .1172145     4.06   0.000     .2450187    .7069649\n          d2 |   .2120021   .1419991     1.49   0.137    -.0678094    .4918136\n          d3 |  -.0270369    .074052    -0.37   0.715    -.1729575    .1188837\n          d4 |     .24435   .1516866     1.61   0.109    -.0545508    .5432508\n          d5 |   .0530065   .0356148     1.49   0.138     -.017173     .123186\n          d6 |   .0575178   .0639555     0.90   0.369    -.0685076    .1835431\n          d7 |   .2971909   .0566882     5.24   0.000      .185486    .4088959\n          d8 |   6.630805   .7652819     8.66   0.000     5.122804    8.138805\n------------------------------------------------------------------------------\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. \n. \n. preserve\n\n. keep if ve==1\n(75 observations deleted)\n\n. \n. gen quality=exp(_b[c8]+_b[b2]+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*h\n> p_c/*\n> */+_b[c5]*tran_c+_b[c6]*ps_c+_b[c7]*ac_c)\n\n. \n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\q\n> uality_c,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\qua\n> lity_c.dta saved\n\n. \n. gen nvalue=quality*quan_c\n\n. egen aquan=mean(quan_c), by(year)\n\n. egen anvalue=mean(nvalue),by(year)\n\n. gen uquality=anvalue/aquan\n\n. collapse (mean)uquality, by(year)\n\n. list\n\n     +-----------------+\n     | year   uquality |\n     |-----------------|\n  1. |   79   4360.772 |\n  2. |   80   4472.789 |\n  3. |   81   4867.316 |\n  4. |   82   5252.845 |\n  5. |   83   5636.667 |\n     |-----------------|\n  6. |   84    5862.13 |\n  7. |   85   6130.052 |\n     +-----------------+\n\n. restore\n\n. \n. preserve\n\n. keep if ve==2\n(179 observations deleted)\n\n. \n. gen quality=exp(_b[d8]+_b[b2]+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*h\n> p_t/*\n> */+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t)\n\n. \n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\q\n> uality_t,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\qua\n> lity_t.dta saved\n\n. \n. gen nvalue=quality*quan_t\n\n. egen aquan=mean(quan_t),by(year)\n\n. egen anvalue=mean(nvalue), by(year)\n\n. gen uquality=anvalue/aquan\n\n. collapse (mean)uquality, by(year)\n\n. list\n\n     +-----------------+\n     | year   uquality |\n     |-----------------|\n  1. |   79   4626.836 |\n  2. |   80   4637.583 |\n  3. |   81   4791.255 |\n  4. |   82   4929.792 |\n  5. |   83   4997.103 |\n     |-----------------|\n  6. |   84   5009.971 |\n  7. |   85   5432.772 |\n     +-----------------+\n\n. restore\n\n. \n. program drop _all\n\n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\unit_quality.log\n  log type:  text\n closed on:  19 Jun 2024, 23:03:38\n----------------------------------------------------------------------------------\n\n. exit\n\nend of do-file\n```\n\n#### qindex_c.do\n\n```stata\nclear\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\qindex_c.log,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\quality_c,clear\nkeep year model type quality quan_c\nren quan_c quan\n\npreserve\nkeep if year==80\nkeep model type quality quan\nren quality quality_80\nren quan quan_80\nsort model\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\quality_80_c,replace\nrestore\n\nsort model\nmerge model using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\quality_80_c\nkeep if _merge==3\ndrop _merge\n\nsort year model\negen value_80=sum(quality_80*quan_80), by(year)\negen value_cp=sum(quality*quan_80), by(year)\ngen lasp=value_cp/value_80\n\negen value_c=sum(quality*quan),by(year)\negen value_cq=sum(quality_80*quan), by(year)\ngen pasp=value_c/value_cq\n\ngen qindex=(lasp*pasp)^0.5\ncollapse (mean) qindex, by(year)\n\nlist\nlog close\n```\n\nOutput:\n\n```stata\n. clear\n\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\qindex_c.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\qindex_c.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\qindex_c.log\n  log type:  text\n opened on:  19 Jun 2024, 23:06:51\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\qu\n> ality_c,clear\n\n. keep year model type quality quan_c\n\n. ren quan_c quan\n\n. \n. preserve\n\n. keep if year==80\n(155 observations deleted)\n\n. keep model type quality quan\n\n. ren quality quality_80\n\n. ren quan quan_80\n\n. sort model\n\n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\q\n> uality_80_c,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\qua\n> lity_80_c.dta saved\n\n. restore\n\n. \n. sort model\n\n. merge model using Z:\\home\\pacha\\github\\advanced-international-trade\\first-editio\n> n\\Chapter-8\\quality_80_c\n(note: you are using old merge syntax; see [R] merge for new syntax)\nvariable model does not uniquely identify observations in the master data\n\n. keep if _merge==3\n(23 observations deleted)\n\n. drop _merge\n\n. \n. sort year model\n\n. egen value_80=sum(quality_80*quan_80), by(year)\n\n. egen value_cp=sum(quality*quan_80), by(year)\n\n. gen lasp=value_cp/value_80\n\n. \n. egen value_c=sum(quality*quan),by(year)\n\n. egen value_cq=sum(quality_80*quan), by(year)\n\n. gen pasp=value_c/value_cq\n\n. \n. gen qindex=(lasp*pasp)^0.5\n\n. collapse (mean) qindex, by(year)\n\n. \n. list\n\n     +-----------------+\n     | year     qindex |\n     |-----------------|\n  1. |   79    .986878 |\n  2. |   80          1 |\n  3. |   81   1.085813 |\n  4. |   82    1.15183 |\n  5. |   83   1.212675 |\n     |-----------------|\n  6. |   84   1.266379 |\n  7. |   85   1.305744 |\n     +-----------------+\n\n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\qindex_c.log\n  log type:  text\n closed on:  19 Jun 2024, 23:06:53\n----------------------------------------------------------------------------------\n\n. \nend of do-file\n```\n\n#### qindex_t.do\n\n```stata\n. clear\n\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\qindex_t.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\qindex_t.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\qindex_t.log\n  log type:  text\n opened on:  19 Jun 2024, 23:09:00\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\qu\n> ality_t,clear\n\n. keep year model type quality quan_t\n\n. ren quan_t quan\n\n. \n. preserve\n\n. keep if year==80\n(65 observations deleted)\n\n. keep model type quality quan\n\n. ren quality quality_80\n\n. ren quan quan_80\n\n. sort model\n\n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\q\n> uality_80_t,replace\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\qua\n> lity_80_t.dta saved\n\n. restore\n\n. \n. sort model\n\n. merge model using Z:\\home\\pacha\\github\\advanced-international-trade\\first-editio\n> n\\Chapter-8\\quality_80_t\n(note: you are using old merge syntax; see [R] merge for new syntax)\nvariable model does not uniquely identify observations in the master data\n\n. keep if _merge==3\n(14 observations deleted)\n\n. drop _merge\n\n. \n. sort year model\n\n. egen value_80=sum(quality_80*quan_80), by(year)\n\n. egen value_cp=sum(quality*quan_80), by(year)\n\n. gen lasp=value_cp/value_80\n\n. \n. egen value_c=sum(quality*quan),by(year)\n\n. egen value_cq=sum(quality_80*quan), by(year)\n\n. gen pasp=value_c/value_cq\n\n. \n. gen qindex=(lasp*pasp)^0.5\n\n. collapse (mean) qindex, by(year)\n\n. \n. list\n\n     +-----------------+\n     | year     qindex |\n     |-----------------|\n  1. |   79   .9956951 |\n  2. |   80          1 |\n  3. |   81   1.035043 |\n  4. |   82   1.058717 |\n  5. |   83   1.057227 |\n     |-----------------|\n  6. |   84   1.053449 |\n  7. |   85   1.160353 |\n     +-----------------+\n\n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\qindex_t.log\n  log type:  text\n closed on:  19 Jun 2024, 23:09:01\n----------------------------------------------------------------------------------\n\n. \nend of do-file\n```\n\n### My code\n\n#### unit_quality.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntruck_7990 <- feenstra_88$truck_7990 %>%\n  filter(year < 86) %>%\n  mutate(ve = 2) %>%\n  rename(\n    quan_t = quan,\n    wdth_t = wdth,\n    hght_t = hght,\n    wght_t = weight,\n    hp_t = hp,\n    four_t = four,\n    tran_t = tran,\n    ps_t = ps,\n    ac_t = ac\n  )\n\ncar_7990 <- feenstra_88$car_7990 %>%\n  filter(year < 86) %>%\n  mutate(ve = 1) %>%\n  rename(\n    quan_c = quan,\n    wdth_c = wdth,\n    hght_c = hght,\n    wght_c = wght,\n    hp_c = hp,\n    four_c = four,\n    tran_c = tran,\n    ps_c = ps,\n    ac_c = ac\n  )\n\ntruck_7990 <- truck_7990 %>%\n  bind_rows(car_7990) %>%\n  mutate(\n    wdth_c = ifelse(is.na(wdth_c), 0, wdth_c),\n    hght_c = ifelse(is.na(hght_c), 0, hght_c),\n    wght_c = ifelse(is.na(wght_c), 0, wght_c),\n    hp_c = ifelse(is.na(hp_c), 0, hp_c),\n    four_c = ifelse(is.na(four_c), 0, four_c),\n    tran_c = ifelse(is.na(tran_c), 0, tran_c),\n    ps_c = ifelse(is.na(ps_c), 0, ps_c),\n    ac_c = ifelse(is.na(ac_c), 0, ac_c),\n    wdth_t = ifelse(is.na(wdth_t), 0, wdth_t),\n    hght_t = ifelse(is.na(hght_t), 0, hght_t),\n    wght_t = ifelse(is.na(wght_t), 0, wght_t),\n    hp_t = ifelse(is.na(hp_t), 0, hp_t),\n    four_t = ifelse(is.na(four_t), 0, four_t),\n    tran_t = ifelse(is.na(tran_t), 0, tran_t),\n    ps_t = ifelse(is.na(ps_t), 0, ps_t),\n    ac_t = ifelse(is.na(ac_t), 0, ac_t)\n  )\n\ntruck_7990 %>%\n  group_by(year) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  mutate(\n    percent = freq / sum(freq) * 100,\n    cum = cumsum(percent)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 4\n   year  freq percent   cum\n  <dbl> <int>   <dbl> <dbl>\n1    79    31    12.2  12.2\n2    80    34    13.4  25.6\n3    81    35    13.8  39.4\n4    82    35    13.8  53.1\n5    83    36    14.2  67.3\n6    84    40    15.7  83.1\n7    85    43    16.9 100  \n```\n:::\n\n```{.r .cell-code}\ntruck_7990 <- truck_7990 %>%\n  mutate(yd = as.factor(year - min(year) + 1))\n\ntruck_7990_dummy <- model.matrix(~ yd - 1, data = truck_7990)\n\ntruck_7990 <- truck_7990 %>%\n  bind_cols(as.data.frame(truck_7990_dummy))\n\ntruck_7990 <- truck_7990 %>%\n  mutate(\n    cyd2 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd2\n    ),\n    tyd2 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd2\n    ),\n    cyd3 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd3\n    ),\n    tyd3 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd3\n    ),\n    cyd4 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd4\n    ),\n    tyd4 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd4\n    ),\n    cyd5 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd5\n    ),\n    tyd5 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd5\n    ),\n    cyd6 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd6\n    ),\n    tyd6 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd6\n    ),\n    cyd7 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd7\n    ),\n    tyd7 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd7\n    )\n  )\n\ninitial_values <- list(\n  a3 = 1, a4 = 1, a5 = 1, a6 = 1, a7 = 1,\n  b2 = 0.1, b3 = 0.1, b4 = 0.1, b5 = 0.1, b6 = 0.1, b7 = 0.1,\n  c1 = 0.1, c2 = 0.1, c3 = 0.1, c4 = 0.1, c5 = 0.1, c6 = 0.1, c7 = 0.1,\n  c8 = 0.1, c9 = 0.1,\n  d1 = 0.1, d2 = 0.1, d3 = 0.1, d4 = 0.1, d5 = 0.1, d6 = 0.1, d7 = 0.1,\n  d8 = 0.1\n)\n\nfit <- nlsLM(\n  price ~ a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * cyd7 +\n    exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + b6 * cyd6 +\n      b7 * cyd7 + c1 * wght_c + c2 * wdth_c + c3 * hght_c + c4 * hp_c +\n      c5 * tran_c + c6 * ps_c + c7 * ac_c + c8) +\n    exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + (b4 + 0.16) * tyd4 +\n      (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + c9 * tyd7 + d1 * wght_t +\n      d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * tran_t + d6 * ps_t +\n      d7 * four_t + d8),\n  data = truck_7990,\n  start = initial_values\n)\n\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: price ~ a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * \n    cyd7 + exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + \n    b6 * cyd6 + b7 * cyd7 + c1 * wght_c + c2 * wdth_c + c3 * \n    hght_c + c4 * hp_c + c5 * tran_c + c6 * ps_c + c7 * ac_c + \n    c8) + exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + (b4 + 0.16) * \n    tyd4 + (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + c9 * tyd7 + \n    d1 * wght_t + d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * \n    tran_t + d6 * ps_t + d7 * four_t + d8)\n\nParameters:\n     Estimate Std. Error t value Pr(>|t|)    \na3  2.542e+02  3.171e+02   0.802 0.423598    \na4  5.052e+02  3.256e+02   1.552 0.122150    \na5  7.090e+02  3.173e+02   2.235 0.026415 *  \na6  1.082e+03  3.224e+02   3.356 0.000926 ***\na7  1.063e+03  3.739e+02   2.843 0.004876 ** \nb2  4.065e-03  3.290e-02   0.124 0.901779    \nb3  7.559e-02  4.906e-02   1.541 0.124732    \nb4  8.284e-02  4.904e-02   1.689 0.092555 .  \nb5  3.276e-02  5.070e-02   0.646 0.518840    \nb6  3.510e-02  5.147e-02   0.682 0.495934    \nb7  8.254e-02  5.576e-02   1.480 0.140197    \nc1  3.261e-02  1.117e-01   0.292 0.770715    \nc2  3.860e-01  1.204e-01   3.205 0.001545 ** \nc3 -1.929e-01  5.683e-02  -3.395 0.000811 ***\nc4  7.152e-01  7.362e-02   9.715  < 2e-16 ***\nc5  1.579e-01  3.382e-02   4.668 5.21e-06 ***\nc6  6.412e-02  2.471e-02   2.595 0.010082 *  \nc7  1.830e-01  2.428e-02   7.535 1.16e-12 ***\nc8  6.599e+00  7.307e-01   9.032  < 2e-16 ***\nc9  1.172e-01  6.342e-02   1.848 0.065932 .  \nd1  4.917e-01  7.958e-02   6.179 2.97e-09 ***\nd2  2.621e-01  1.757e-01   1.492 0.137107    \nd3 -4.513e-02  6.770e-02  -0.667 0.505752    \nd4  3.031e-01  1.701e-01   1.782 0.076158 .  \nd5  3.978e-02  3.627e-02   1.097 0.273899    \nd6  9.676e-02  5.018e-02   1.928 0.055072 .  \nd7  3.052e-01  7.156e-02   4.265 2.94e-05 ***\nd8  6.300e+00  9.620e-01   6.549 3.85e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 666.9 on 226 degrees of freedom\n\nNumber of iterations to convergence: 30 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n\n```{.r .cell-code}\nfit_coef <- coef(fit)\n\ntruck_7990 <- truck_7990 %>%\n  mutate(\n    winv = case_when(\n      ve == 1 ~ 1 / exp(fit_coef[\"b2\"] * cyd2 + fit_coef[\"b3\"] * cyd3 +\n        fit_coef[\"b4\"] * cyd4 + fit_coef[\"b5\"] * cyd5 +\n        fit_coef[\"b6\"] * cyd6 + fit_coef[\"b7\"] * cyd7 +\n        fit_coef[\"c1\"] * wght_c + fit_coef[\"c2\"] * wdth_c +\n        fit_coef[\"c3\"] * hght_c + fit_coef[\"c4\"] * hp_c +\n        fit_coef[\"c5\"] * tran_c + fit_coef[\"c6\"] * ps_c +\n        fit_coef[\"c7\"] * ac_c + fit_coef[\"c8\"]),\n      ve == 2 ~ 1 / exp((fit_coef[\"b2\"] + 0.16) * tyd2 +\n        (fit_coef[\"b3\"] + 0.16) * tyd3 + (fit_coef[\"b4\"] + 0.16) * tyd4 +\n        (fit_coef[\"b5\"] + 0.16) * tyd5 + (fit_coef[\"b6\"] + 0.16) * tyd6 +\n        fit_coef[\"c9\"] * tyd7 + fit_coef[\"d1\"] * wght_t +\n        fit_coef[\"d2\"] * wdth_t + fit_coef[\"d3\"] * hght_t +\n        fit_coef[\"d4\"] * hp_t + fit_coef[\"d5\"] * tran_t +\n        fit_coef[\"d6\"] * ps_t + fit_coef[\"d7\"] * four_t + fit_coef[\"d8\"])\n    ),\n    nprice = price * winv\n  )\n\nfit2 <- nlsLM(\n  nprice ~ winv * (a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * cyd7) +\n    winv * exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + b6 * cyd6 +\n      b7 * cyd7 + c1 * wght_c + c2 * wdth_c + c3 * hght_c + c4 * hp_c +\n      c5 * tran_c + c6 * ps_c + c7 * ac_c + c8) +\n    winv * exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + (b4 + 0.16) * tyd4 +\n      (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + c9 * tyd7 + d1 * wght_t +\n      d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * tran_t + d6 * ps_t +\n      d7 * four_t + d8),\n  data = truck_7990,\n  start = initial_values\n)\n\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: nprice ~ winv * (a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + \n    a7 * cyd7) + winv * exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + \n    b5 * cyd5 + b6 * cyd6 + b7 * cyd7 + c1 * wght_c + c2 * wdth_c + \n    c3 * hght_c + c4 * hp_c + c5 * tran_c + c6 * ps_c + c7 * \n    ac_c + c8) + winv * exp(b2 * tyd2 + (b3 + 0.16) * tyd3 + \n    (b4 + 0.16) * tyd4 + (b5 + 0.16) * tyd5 + (b6 + 0.16) * tyd6 + \n    c9 * tyd7 + d1 * wght_t + d2 * wdth_t + d3 * hght_t + d4 * \n    hp_t + d5 * tran_t + d6 * ps_t + d7 * four_t + d8)\n\nParameters:\n     Estimate Std. Error t value Pr(>|t|)    \na3  3.679e+02  2.391e+02   1.539 0.125219    \na4  6.005e+02  2.543e+02   2.362 0.019041 *  \na5  8.879e+02  2.436e+02   3.645 0.000332 ***\na6  1.104e+03  2.511e+02   4.399 1.68e-05 ***\na7  8.556e+02  3.663e+02   2.336 0.020379 *  \nb2  1.304e-02  3.031e-02   0.430 0.667488    \nb3  6.745e-02  4.252e-02   1.586 0.114086    \nb4  7.013e-02  4.419e-02   1.587 0.113886    \nb5 -5.484e-04  4.708e-02  -0.012 0.990718    \nb6  1.801e-02  4.740e-02   0.380 0.704268    \nb7  1.008e-01  6.416e-02   1.571 0.117554    \nc1  4.925e-02  1.311e-01   0.376 0.707523    \nc2  3.908e-01  1.383e-01   2.825 0.005153 ** \nc3 -6.182e-02  6.114e-02  -1.011 0.313088    \nc4  8.103e-01  1.038e-01   7.807 2.17e-13 ***\nc5  1.779e-01  3.552e-02   5.009 1.10e-06 ***\nc6  6.936e-02  3.049e-02   2.275 0.023864 *  \nc7  1.567e-01  3.604e-02   4.348 2.08e-05 ***\nc8  5.839e+00  8.619e-01   6.775 1.07e-10 ***\nc9  1.060e-01  5.506e-02   1.925 0.055494 .  \nd1  4.760e-01  1.172e-01   4.060 6.76e-05 ***\nd2  2.121e-01  1.420e-01   1.493 0.136773    \nd3 -2.704e-02  7.406e-02  -0.365 0.715380    \nd4  2.443e-01  1.517e-01   1.611 0.108659    \nd5  5.301e-02  3.562e-02   1.488 0.138112    \nd6  5.751e-02  6.396e-02   0.899 0.369534    \nd7  2.972e-01  5.670e-02   5.242 3.64e-07 ***\nd8  6.630e+00  7.655e-01   8.661 8.98e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1144 on 226 degrees of freedom\n\nNumber of iterations to convergence: 31 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n\n```{.r .cell-code}\nfit2_coef <- coef(fit2)\n\ntruck_7990_2 <- truck_7990 %>%\n  filter(ve == 1) %>%\n  mutate(\n    quality = exp(fit2_coef[\"c8\"] + fit2_coef[\"b2\"] + fit2_coef[\"c1\"] * wght_c +\n      fit2_coef[\"c2\"] * wdth_c + fit2_coef[\"c3\"] * hght_c +\n      fit2_coef[\"c4\"] * hp_c + fit2_coef[\"c5\"] * tran_c +\n      fit2_coef[\"c6\"] * ps_c + fit2_coef[\"c7\"] * ac_c),\n    nvalue = quality * quan_c\n  )\n\ntruck_7990_2 %>%\n  group_by(year) %>%\n  summarise(\n    aquan = mean(quan_c),\n    anvalue = mean(nvalue)\n  ) %>%\n  ungroup() %>%\n  mutate(uquality = anvalue / aquan) %>%\n  group_by(year) %>%\n  summarise(mean_uquality = mean(uquality))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 2\n   year mean_uquality\n  <dbl>         <dbl>\n1    79         4361.\n2    80         4473.\n3    81         4868.\n4    82         5253.\n5    83         5637.\n6    84         5862.\n7    85         6130.\n```\n:::\n\n```{.r .cell-code}\ntruck_7990_3 <- truck_7990 %>%\n  filter(ve == 2) %>%\n  mutate(\n    quality = exp(fit2_coef[\"d8\"] + fit2_coef[\"b2\"] + fit2_coef[\"d1\"] * wght_t +\n      fit2_coef[\"d2\"] * wdth_t + fit2_coef[\"d3\"] * hght_t +\n      fit2_coef[\"d4\"] * hp_t + fit2_coef[\"d5\"] * tran_t +\n      fit2_coef[\"d6\"] * ps_t + fit2_coef[\"d7\"] * four_t),\n    nvalue = quality * quan_t\n  )\n\ntruck_7990_3 %>%\n  group_by(year) %>%\n  summarise(\n    aquan = mean(quan_t),\n    anvalue = mean(nvalue)\n  ) %>%\n  ungroup() %>%\n  mutate(uquality = anvalue / aquan) %>%\n  group_by(year) %>%\n  summarise(mean_uquality = mean(uquality))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 2\n   year mean_uquality\n  <dbl>         <dbl>\n1    79         4627.\n2    80         4637.\n3    81         4791.\n4    82         4930.\n5    83         4997.\n6    84         5010.\n7    85         5433.\n```\n:::\n:::\n\n\n#### qindex_c.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntruck_7990_2_80 <- truck_7990_2 %>%\n  filter(year == 80) %>%\n  select(model, type, quality, quan_c) %>%\n  rename(\n    quality_80 = quality,\n    quan_80 = quan_c\n  )\n\ntruck_7990_2 %>%\n  select(year, model, type, quality, quan_c) %>%\n  inner_join(truck_7990_2_80, by = c(\"model\", \"type\")) %>%\n  group_by(year, model) %>%\n  mutate(\n    value_80 = sum(quality_80 * quan_80),\n    value_cp = sum(quality * quan_80),\n    lasp = value_cp / value_80\n  ) %>%\n  group_by(year) %>%\n  mutate(\n    value_c = sum(quality * quan_c),\n    value_cq = sum(quality_80 * quan_c),\n    pasp = value_c / value_cq,\n    qindex = sqrt(lasp * pasp)\n  ) %>%\n  summarise(mean_qindex = mean(qindex))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 2\n   year mean_qindex\n  <dbl>       <dbl>\n1    79       0.985\n2    80       1    \n3    81       1.09 \n4    82       1.14 \n5    83       1.20 \n6    84       1.26 \n7    85       1.33 \n```\n:::\n:::\n\n\n#### qindex_t.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntruck_7990_3_80 <- truck_7990_3 %>%\n  filter(year == 80) %>%\n  select(model, type, quality, quan_t) %>%\n  rename(\n    quality_80 = quality,\n    quan_80 = quan_t\n  )\n\ntruck_7990_3 %>%\n  select(year, model, type, quality, quan_t) %>%\n  inner_join(truck_7990_3_80, by = c(\"model\", \"type\")) %>%\n  group_by(year, model) %>%\n  mutate(\n    value_80 = sum(quality_80 * quan_80),\n    value_tp = sum(quality * quan_80),\n    lasp = value_tp / value_80\n  ) %>%\n  group_by(year) %>%\n  mutate(\n    value_t = sum(quality * quan_t),\n    value_tq = sum(quality_80 * quan_t),\n    pasp = value_t / value_tq,\n    qindex = sqrt(lasp * pasp)\n  ) %>%\n  summarise(mean_qindex = mean(qindex))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 2\n   year mean_qindex\n  <dbl>       <dbl>\n1    79       0.983\n2    80       1    \n3    81       1.03 \n4    82       1.06 \n5    83       1.05 \n6    84       1.07 \n7    85       1.17 \n```\n:::\n:::\n\n\n## Exercise 5\n\nPooling car and truck data, run `system_nocom.do` and `system_wcon.do` to reproduce columns (1) – (4) in Table 8.5, with constraints specified in equation (8.22).\n\n### Feenstra's code\n\n#### system_nocom.do\n\nI think there is a typo in the original code, in specific in the lines:\n\n```stata\ngen cyd10=yd10\ngen tyd10=yd10\nreplace cyd7=10 if type==\"JT\"\nreplace tyd7=10 if type~=\"JT\"\n\ngen cyd11=yd11\ngen tyd11=yd11\nreplace cyd7=11 if type==\"JT\"\nreplace tyd7=11 if type~=\"JT\"\n\ngen cyd12=yd12\ngen tyd12=yd12\nreplace cyd7=12 if type==\"JT\"\nreplace tyd7=12 if type~=\"JT\"\n```\n\nTo me, it is not clear why overwriting `cyd7` three times instead of replacing with \"12\" in one step. I corrected `cyd10`, `cyd11`, and `cyd12` below.\n\n```stata\ncapture log close\nlog using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\system_nocon.log,replace\n\nset matsize 400\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_7990,clear\ngen ve=2\nrename wdth wdth_t\nrename hght hght_t\nrename weight wght_t\nrename hp hp_t\nrename four four_t\nrename tran tran_t\nrename ps ps_t\nrename ac ac_t\n\nsave Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_temp,replace\n\nuse Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\car_7990,clear\ngen ve=1\nrename wdth wdth_c\nrename hght hght_c\nrename wght wght_c\nrename hp hp_c\nrename four four_c\nrename tran tran_c\nrename ps ps_c\nrename ac ac_c\n\nappend using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\truck_temp\n\nreplace wdth_c=0 if wdth_c==.\nreplace hght_c=0 if hght_c==.\nreplace wght_c=0 if wght_c==.\nreplace hp_c=0 if hp_c==.\nreplace four_c=0 if four_c==.\nreplace tran_c=0 if tran_c==.\nreplace ps_c=0 if ps_c==.\nreplace ac_c=0 if ac_c==.\nreplace wdth_t=0 if wdth_t==.\nreplace hght_t=0 if hght_t==.\nreplace wght_t=0 if wght_t==.\nreplace hp_t=0 if hp_t==.\nreplace four_t=0 if four_t==.\nreplace tran_t=0 if tran_t==.\nreplace ps_t=0 if ps_t==.\nreplace ac_t=0 if ac_t==.\n\ntab year, gen(yd)\n\ngen cyd2=yd2\ngen tyd2=yd2\nreplace cyd2=0 if type==\"JT\"\nreplace tyd2=0 if type~=\"JT\"\n\ngen cyd3=yd3\ngen tyd3=yd3\nreplace cyd3=0 if type==\"JT\"\nreplace tyd3=0 if type~=\"JT\"\n\ngen cyd4=yd4\ngen tyd4=yd4\nreplace cyd4=0 if type==\"JT\"\nreplace tyd4=0 if type~=\"JT\"\n\ngen cyd5=yd5\ngen tyd5=yd5\nreplace cyd5=0 if type==\"JT\"\nreplace tyd5=0 if type~=\"JT\"\n\ngen cyd6=yd6\ngen tyd6=yd6\nreplace cyd6=0 if type==\"JT\"\nreplace tyd6=0 if type~=\"JT\"\n\ngen cyd7=yd7\ngen tyd7=yd7\nreplace cyd7=0 if type==\"JT\"\nreplace tyd7=0 if type~=\"JT\"\n\ngen cyd8=yd8\ngen tyd8=yd8\nreplace cyd8=0 if type==\"JT\"\nreplace tyd8=0 if type~=\"JT\"\n\ngen cyd9=yd9\ngen tyd9=yd9\nreplace cyd9=0 if type==\"JT\"\nreplace tyd9=0 if type~=\"JT\"\n\ngen cyd10=yd10\ngen tyd10=yd10\nreplace cyd10=0 if type==\"JT\"\nreplace tyd10=0 if type~=\"JT\"\n\ngen cyd11=yd11\ngen tyd11=yd11\nreplace cyd11=0 if type==\"JT\"\nreplace tyd11=0 if type~=\"JT\"\n\ngen cyd12=yd12\ngen tyd12=yd12\nreplace cyd12=0 if type==\"JT\"\nreplace tyd12=0 if type~=\"JT\"\n\nprogram define nlct_1\nversion 7.0\nif \"`1'\"==\"?\"{\nglobal S_1 \"a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 c1 c2 c3 c4 c5 c6 c7 c8 d1 d2 d3 d4 d5 d6 d7 d8 e2 e3 e4 e5 e6 e7 e8 e9 e10 e11 e12\"\nglobal a3=1\nglobal a4=1\nglobal a5=1\nglobal a6=1\nglobal a7=1\nglobal a8=1\nglobal a9=1\nglobal a10=1\nglobal a11=1\nglobal a12=1\nglobal b2=.1\nglobal b3=.1\nglobal b4=.1\nglobal b5=.1\nglobal b6=.1\nglobal b7=.1\nglobal b8=.1\nglobal b9=.1\nglobal b10=.1\nglobal b11=.1\nglobal b12=.1\nglobal c1=.1\nglobal c2=.1\nglobal c3=.1\nglobal c4=.1\nglobal c5=.1\nglobal c6=.1\nglobal c7=.1\nglobal c8=.1\nglobal d1=.1\nglobal d2=.1\nglobal d3=.1\nglobal d4=.1\nglobal d5=.1\nglobal d6=.1\nglobal d7=.1\nglobal d8=.1\nglobal e2=.1\nglobal e3=.1\nglobal e4=.1\nglobal e5=.1\nglobal e6=.1\nglobal e7=.1\nglobal e8=.1\nglobal e9=.1\nglobal e10=.1\nglobal e11=.1\nglobal e12=.1\nexit\n}\n\nreplace `1'=$a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n*/+$a8*cyd8+$a9*cyd9+$a10*cyd10+$a11*cyd11+$a12*cyd12/*\n*/+exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n*/+$b8*cyd8+$b9*cyd9+$b10*cyd10+$b11*cyd11+$b12*cyd12/*\n*/+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n*/+$c8)+exp($e2*tyd2+$e3*tyd3+$e4*tyd4+$e5*tyd5+$e6*tyd6+$e7*tyd7/*\n*/+$e8*tyd8+$e9*tyd9+$e10*tyd10+$e11*tyd11+$e12*tyd12/*\n*/+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n\nend\n\nnl ct_1 price\n\ngen winv=1/exp(_b[b2]*cyd2+_b[b3]*cyd3+_b[b4]*cyd4+_b[b5]*cyd5+_b[b6]*cyd6+_b[b7]*cyd7/*\n*/+_b[b8]*cyd8+_b[b9]*cyd9+_b[b10]*cyd10+_b[b11]*cyd11+_b[b12]*cyd12/*\n*/+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*hp_c+_b[c5]*tran_c+_b[c6]*ps_c/*\n*/+_b[c7]*ac_c+_b[c8])\n\nreplace winv=1/exp(_b[e2]*tyd2+_b[e3]*tyd3+_b[e4]*tyd4+_b[e5]*tyd5+_b[e6]*tyd6/*\n*/+_b[e7]*tyd7+_b[e8]*tyd8+_b[e9]*tyd9+_b[e10]*tyd10+_b[e11]*tyd11+_b[e12]*tyd12/*\n*/+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*hp_t/*\n*/+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t+_b[d8]) if ve==2\n\ngen nprice=price*winv\n\n\nprogram define nlct_2\nversion 7.0\nif \"`1'\"==\"?\"{\nglobal S_1 \"a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 c1 c2 c3 c4 c5 c6 c7 c8 d1 d2 d3 d4 d5 d6 d7 d8 e2 e3 e4 e5 e6 e7 e8 e9 e10 e11 e12\"\nglobal a3=1\nglobal a4=1\nglobal a5=1\nglobal a6=1\nglobal a7=1\nglobal a8=1\nglobal a9=1\nglobal a10=1\nglobal a11=1\nglobal a12=1\nglobal b2=.1\nglobal b3=.1\nglobal b4=.1\nglobal b5=.1\nglobal b6=.1\nglobal b7=.1\nglobal b8=.1\nglobal b9=.1\nglobal b10=.1\nglobal b11=.1\nglobal b12=.1\nglobal c1=.1\nglobal c2=.1\nglobal c3=.1\nglobal c4=.1\nglobal c5=.1\nglobal c6=.1\nglobal c7=.1\nglobal c8=.1\nglobal d1=.1\nglobal d2=.1\nglobal d3=.1\nglobal d4=.1\nglobal d5=.1\nglobal d6=.1\nglobal d7=.1\nglobal d8=.1\nglobal e2=.1\nglobal e3=.1\nglobal e4=.1\nglobal e5=.1\nglobal e6=.1\nglobal e7=.1\nglobal e8=.1\nglobal e9=.1\nglobal e10=.1\nglobal e11=.1\nglobal e12=.1\nexit\n}\n\nreplace `1'=winv*($a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n*/+$a8*cyd8+$a9*cyd9+$a10*cyd10+$a11*cyd11+$a12*cyd12)/*\n*/+winv*exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n*/+$b8*cyd8+$b9*cyd9+$b10*cyd10+$b11*cyd11+$b12*cyd12/*\n*/+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n*/+$c8)+winv*exp($e2*tyd2+$e3*tyd3+$e4*tyd4+$e5*tyd5+$e6*tyd6+$e7*tyd7/*\n*/+$e8*tyd8+$e9*tyd9+$e10*tyd10+$e11*tyd11+$e12*tyd12/*\n*/+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n\nend\n\nnl ct_2 nprice\n\nprogram drop _all\nlog close\nexit\n```\n\nOutput:\n\n```stata\n\n. capture log close\n\n. log using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\system_nocon.log,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\system_nocon.log not found)\n----------------------------------------------------------------------------------\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\system_nocon.log\n  log type:  text\n opened on:  24 Jun 2024, 00:33:59\n\n. \n. set matsize 400\n\nCurrent memory allocation\n\n                    current                                 memory usage\n    settable          value     description                 (1M = 1024k)\n    --------------------------------------------------------------------\n    set maxvar         5000     max. variables allowed           1.909M\n    set memory           50M    max. data space                 50.000M\n    set matsize         400     max. RHS vars in models          1.254M\n                                                            -----------\n                                                                53.163M\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tr\n> uck_7990,clear\n\n. gen ve=2\n\n. rename wdth wdth_t\n\n. rename hght hght_t\n\n. rename weight wght_t\n\n. rename hp hp_t\n\n. rename four four_t\n\n. rename tran tran_t\n\n. rename ps ps_t\n\n. rename ac ac_t\n\n. \n. save Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\t\n> ruck_temp,replace\n(note: file Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapte\n> r-8\\truck_temp.dta not found)\nfile Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\tru\n> ck_temp.dta saved\n\n. \n. use Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapter-8\\ca\n> r_7990,clear\n\n. gen ve=1\n\n. rename wdth wdth_c\n\n. rename hght hght_c\n\n. rename wght wght_c\n\n. rename hp hp_c\n\n. rename four four_c\n\n. rename tran tran_c\n\n. rename ps ps_c\n\n. rename ac ac_c\n\n. \n. append using Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Cha\n> pter-8\\truck_temp\n\n. \n. replace wdth_c=0 if wdth_c==.\n(120 real changes made)\n\n. replace hght_c=0 if hght_c==.\n(120 real changes made)\n\n. replace wght_c=0 if wght_c==.\n(120 real changes made)\n\n. replace hp_c=0 if hp_c==.\n(120 real changes made)\n\n. replace four_c=0 if four_c==.\n(120 real changes made)\n\n. replace tran_c=0 if tran_c==.\n(120 real changes made)\n\n. replace ps_c=0 if ps_c==.\n(120 real changes made)\n\n. replace ac_c=0 if ac_c==.\n(120 real changes made)\n\n. replace wdth_t=0 if wdth_t==.\n(284 real changes made)\n\n. replace hght_t=0 if hght_t==.\n(284 real changes made)\n\n. replace wght_t=0 if wght_t==.\n(284 real changes made)\n\n. replace hp_t=0 if hp_t==.\n(284 real changes made)\n\n. replace four_t=0 if four_t==.\n(284 real changes made)\n\n. replace tran_t=0 if tran_t==.\n(284 real changes made)\n\n. replace ps_t=0 if ps_t==.\n(284 real changes made)\n\n. replace ac_t=0 if ac_t==.\n(284 real changes made)\n\n. \n. tab year, gen(yd)\n\n       year |      Freq.     Percent        Cum.\n------------+-----------------------------------\n         79 |         31        7.67        7.67\n         80 |         34        8.42       16.09\n         81 |         35        8.66       24.75\n         82 |         35        8.66       33.42\n         83 |         36        8.91       42.33\n         84 |         40        9.90       52.23\n         85 |         43       10.64       62.87\n         86 |         33        8.17       71.04\n         87 |         35        8.66       79.70\n         88 |         30        7.43       87.13\n         89 |         26        6.44       93.56\n         90 |         26        6.44      100.00\n------------+-----------------------------------\n      Total |        404      100.00\n\n. \n. gen cyd2=yd2\n\n. gen tyd2=yd2\n\n. replace cyd2=0 if type==\"JT\"\n(8 real changes made)\n\n. replace tyd2=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd3=yd3\n\n. gen tyd3=yd3\n\n. replace cyd3=0 if type==\"JT\"\n(9 real changes made)\n\n. replace tyd3=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd4=yd4\n\n. gen tyd4=yd4\n\n. replace cyd4=0 if type==\"JT\"\n(9 real changes made)\n\n. replace tyd4=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd5=yd5\n\n. gen tyd5=yd5\n\n. replace cyd5=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd5=0 if type~=\"JT\"\n(29 real changes made)\n\n. \n. gen cyd6=yd6\n\n. gen tyd6=yd6\n\n. replace cyd6=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd6=0 if type~=\"JT\"\n(33 real changes made)\n\n. \n. gen cyd7=yd7\n\n. gen tyd7=yd7\n\n. replace cyd7=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd7=0 if type~=\"JT\"\n(36 real changes made)\n\n. \n. gen cyd8=yd8\n\n. gen tyd8=yd8\n\n. replace cyd8=0 if type==\"JT\"\n(7 real changes made)\n\n. replace tyd8=0 if type~=\"JT\"\n(26 real changes made)\n\n. \n. gen cyd9=yd9\n\n. gen tyd9=yd9\n\n. replace cyd9=0 if type==\"JT\"\n(6 real changes made)\n\n. replace tyd9=0 if type~=\"JT\"\n(29 real changes made)\n\n. \n. gen cyd10=yd10\n\n. gen tyd10=yd10\n\n. replace cyd10=0 if type==\"JT\"\n(5 real changes made)\n\n. replace tyd10=0 if type~=\"JT\"\n(25 real changes made)\n\n. \n. gen cyd11=yd11\n\n. gen tyd11=yd11\n\n. replace cyd11=0 if type==\"JT\"\n(6 real changes made)\n\n. replace tyd11=0 if type~=\"JT\"\n(20 real changes made)\n\n. \n. gen cyd12=yd12\n\n. gen tyd12=yd12\n\n. replace cyd12=0 if type==\"JT\"\n(5 real changes made)\n\n. replace tyd12=0 if type~=\"JT\"\n(21 real changes made)\n\n. \n. program define nlct_1\n  1. version 7.0\n  2. if \"`1'\"==\"?\"{\n  3. global S_1 \"a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 \n> b12 c1 c2 c3 c4 c5 c6 c7 c8 d1 d2 d3 d4 d5 d6 d7 d8 e2 e3 e4 e5 e6 e7 e8 e9 e10 \n> e11 e12\"\n  4. global a3=1\n  5. global a4=1\n  6. global a5=1\n  7. global a6=1\n  8. global a7=1\n  9. global a8=1\n 10. global a9=1\n 11. global a10=1\n 12. global a11=1\n 13. global a12=1\n 14. global b2=.1\n 15. global b3=.1\n 16. global b4=.1\n 17. global b5=.1\n 18. global b6=.1\n 19. global b7=.1\n 20. global b8=.1\n 21. global b9=.1\n 22. global b10=.1\n 23. global b11=.1\n 24. global b12=.1\n 25. global c1=.1\n 26. global c2=.1\n 27. global c3=.1\n 28. global c4=.1\n 29. global c5=.1\n 30. global c6=.1\n 31. global c7=.1\n 32. global c8=.1\n 33. global d1=.1\n 34. global d2=.1\n 35. global d3=.1\n 36. global d4=.1\n 37. global d5=.1\n 38. global d6=.1\n 39. global d7=.1\n 40. global d8=.1\n 41. global e2=.1\n 42. global e3=.1\n 43. global e4=.1\n 44. global e5=.1\n 45. global e6=.1\n 46. global e7=.1\n 47. global e8=.1\n 48. global e9=.1\n 49. global e10=.1\n 50. global e11=.1\n 51. global e12=.1\n 52. exit\n 53. }\n 54. \n. replace `1'=$a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n> */+$a8*cyd8+$a9*cyd9+$a10*cyd10+$a11*cyd11+$a12*cyd12/*\n> */+exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n> */+$b8*cyd8+$b9*cyd9+$b10*cyd10+$b11*cyd11+$b12*cyd12/*\n> */+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n> */+$c8)+exp($e2*tyd2+$e3*tyd3+$e4*tyd4+$e5*tyd5+$e6*tyd6+$e7*tyd7/*\n> */+$e8*tyd8+$e9*tyd9+$e10*tyd10+$e11*tyd11+$e12*tyd12/*\n> */+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n 55. \n. end\n\n. \n. nl ct_1 price\n(obs = 404)\n\nIteration 0:   residual SS =  3.69e+10\n...\nIteration 59:  residual SS =  3.48e+08\nIteration 60:  residual SS =  3.48e+08\n\n      Source |       SS       df       MS            Number of obs =       404\n-------------+------------------------------         F( 45,   358) =    134.73\n       Model |  5.8946e+09    45   130990377         Prob > F      =    0.0000\n    Residual |   348069386   358  972260.856         R-squared     =    0.9442\n-------------+------------------------------         Adj R-squared =    0.9372\n       Total |  6.2426e+09   403  15490412.8         Root MSE      =  986.0329\n                                                     Res. dev.     =  6667.767\n(ct_1)\n------------------------------------------------------------------------------\n       price |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |  -591.4105   1021.533    -0.58   0.563    -2600.371     1417.55\n          a4 |  -1145.046   1057.554    -1.08   0.280    -3224.844    934.7527\n          a5 |  -824.1875    1016.79    -0.81   0.418    -2823.819    1175.444\n          a6 |  -592.6532   1010.202    -0.59   0.558    -2579.329    1394.023\n          a7 |  -1306.657     1083.9    -1.21   0.229    -3438.268    824.9532\n          a8 |  -98.11828   1087.933    -0.09   0.928    -2237.661    2041.425\n          a9 |  -257.0587   1177.715    -0.22   0.827    -2573.168     2059.05\n         a10 |  -413.3716   1310.795    -0.32   0.753    -2991.198    2164.455\n         a11 |  -1220.982   1430.616    -0.85   0.394     -4034.45    1592.486\n         a12 |  -1076.411   1450.708    -0.74   0.459    -3929.392    1776.569\n          b2 |   .0197206   .0474133     0.42   0.678    -.0735229    .1129641\n          b3 |   .2183407   .1415785     1.54   0.124    -.0600893    .4967707\n          b4 |   .3398839   .1306741     2.60   0.010     .0828985    .5968693\n          b5 |     .30743    .128895     2.39   0.018     .0539436    .5609165\n          b6 |    .338236   .1254585     2.70   0.007     .0915077    .5849643\n          b7 |   .4292664   .1225126     3.50   0.001     .1883316    .6702011\n          b8 |   .3855295   .1262504     3.05   0.002     .1372438    .6338152\n          b9 |   .4743625   .1264804     3.75   0.000     .2256246    .7231004\n         b10 |   .5337515   .1278549     4.17   0.000     .2823104    .7851925\n         b11 |   .6487194   .1271098     5.10   0.000     .3987437    .8986951\n         b12 |   .6188886   .1311527     4.72   0.000      .360962    .8768152\n          c1 |   .4598504   .0886104     5.19   0.000      .285588    .6341127\n          c2 |   .1780578   .0341819     5.21   0.000     .1108352    .2452803\n          c3 |  -.3850267   .0481769    -7.99   0.000     -.479772   -.2902814\n          c4 |   .2680433   .0393044     6.82   0.000     .1907467    .3453399\n          c5 |   .0679777   .0194236     3.50   0.001      .029779    .1061764\n          c6 |   .0932556    .021253     4.39   0.000     .0514591     .135052\n          c7 |   .1534133    .021252     7.22   0.000     .1116189    .1952077\n          c8 |   8.572183   .0409525   209.32   0.000     8.491646    8.652721\n          d1 |   1.024883   .2198255     4.66   0.000     .5925712    1.457194\n          d2 |   .5861134   .7924544     0.74   0.460    -.9723374    2.144564\n          d3 |   -.149842   .2155522    -0.70   0.487    -.5737496    .2740656\n          d4 |   1.150419    .347234     3.31   0.001     .4675444    1.833294\n          d5 |   .3132963   .1385789     2.26   0.024     .0407654    .5858273\n          d6 |   .0163816   .1407749     0.12   0.907     -.260468    .2932313\n          d7 |   226.2423   4.491789    50.37   0.000     217.4087    235.0759\n          d8 |  -223.6678          .        .       .            .           .\n          e2 |  -9.321882          .        .       .            .           .\n          e3 |   225.8105   4.416818    51.13   0.000     217.1244    234.4967\n          e4 |    225.818   4.410297    51.20   0.000     217.1447    234.4914\n          e5 |   225.3464   4.385453    51.38   0.000      216.722    233.9709\n          e6 |   225.4068   4.379008    51.47   0.000      216.795    234.0186\n          e7 |   225.3594   4.388533    51.35   0.000     216.7288    233.9899\n          e8 |   225.6487   4.417134    51.08   0.000     216.9619    234.3355\n          e9 |   225.5402   4.407819    51.17   0.000     216.8718    234.2087\n         e10 |   226.0232   4.412848    51.22   0.000     217.3448    234.7015\n         e11 |   226.0775   4.462525    50.66   0.000     217.3015    234.8536\n         e12 |    226.117   4.421014    51.15   0.000     217.4226    234.8115\n------------------------------------------------------------------------------\n* Parameter e2 taken as constant term in model & ANOVA table\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. \n. gen winv=1/exp(_b[b2]*cyd2+_b[b3]*cyd3+_b[b4]*cyd4+_b[b5]*cyd5+_b[b6]*cyd6+_b[b7\n> ]*cyd7/*\n> */+_b[b8]*cyd8+_b[b9]*cyd9+_b[b10]*cyd10+_b[b11]*cyd11+_b[b12]*cyd12/*\n> */+_b[c1]*wght_c+_b[c2]*wdth_c+_b[c3]*hght_c+_b[c4]*hp_c+_b[c5]*tran_c+_b[c6]*ps\n> _c/*\n> */+_b[c7]*ac_c+_b[c8])\n\n. \n. replace winv=1/exp(_b[e2]*tyd2+_b[e3]*tyd3+_b[e4]*tyd4+_b[e5]*tyd5+_b[e6]*tyd6/*\n> */+_b[e7]*tyd7+_b[e8]*tyd8+_b[e9]*tyd9+_b[e10]*tyd10+_b[e11]*tyd11+_b[e12]*tyd12\n> /*\n> */+_b[d1]*wght_t+_b[d2]*wdth_t+_b[d3]*hght_t+_b[d4]*hp_t/*\n> */+_b[d5]*tran_t+_b[d6]*ps_t+_b[d7]*four_t+_b[d8]) if ve==2\n(120 real changes made, 18 to missing)\n\n. \n. gen nprice=price*winv\n(18 missing values generated)\n\n. \n. \n. program define nlct_2\n  1. version 7.0\n  2. if \"`1'\"==\"?\"{\n  3. global S_1 \"a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 \n> b12 c1 c2 c3 c4 c5 c6 c7 c8 d1 d2 d3 d4 d5 d6 d7 d8 e2 e3 e4 e5 e6 e7 e8 e9 e10 \n> e11 e12\"\n  4. global a3=1\n  5. global a4=1\n  6. global a5=1\n  7. global a6=1\n  8. global a7=1\n  9. global a8=1\n 10. global a9=1\n 11. global a10=1\n 12. global a11=1\n 13. global a12=1\n 14. global b2=.1\n 15. global b3=.1\n 16. global b4=.1\n 17. global b5=.1\n 18. global b6=.1\n 19. global b7=.1\n 20. global b8=.1\n 21. global b9=.1\n 22. global b10=.1\n 23. global b11=.1\n 24. global b12=.1\n 25. global c1=.1\n 26. global c2=.1\n 27. global c3=.1\n 28. global c4=.1\n 29. global c5=.1\n 30. global c6=.1\n 31. global c7=.1\n 32. global c8=.1\n 33. global d1=.1\n 34. global d2=.1\n 35. global d3=.1\n 36. global d4=.1\n 37. global d5=.1\n 38. global d6=.1\n 39. global d7=.1\n 40. global d8=.1\n 41. global e2=.1\n 42. global e3=.1\n 43. global e4=.1\n 44. global e5=.1\n 45. global e6=.1\n 46. global e7=.1\n 47. global e8=.1\n 48. global e9=.1\n 49. global e10=.1\n 50. global e11=.1\n 51. global e12=.1\n 52. exit\n 53. }\n 54. \n. replace `1'=winv*($a3*cyd3+$a4*cyd4+$a5*cyd5+$a6*cyd6+$a7*cyd7/*\n> */+$a8*cyd8+$a9*cyd9+$a10*cyd10+$a11*cyd11+$a12*cyd12)/*\n> */+winv*exp($b2*cyd2+$b3*cyd3+$b4*cyd4+$b5*cyd5+$b6*cyd6+$b7*cyd7/*\n> */+$b8*cyd8+$b9*cyd9+$b10*cyd10+$b11*cyd11+$b12*cyd12/*\n> */+$c1*wght_c+$c2*wdth_c+$c3*hght_c+$c4*hp_c+$c5*tran_c+$c6*ps_c+$c7*ac_c/*\n> */+$c8)+winv*exp($e2*tyd2+$e3*tyd3+$e4*tyd4+$e5*tyd5+$e6*tyd6+$e7*tyd7/*\n> */+$e8*tyd8+$e9*tyd9+$e10*tyd10+$e11*tyd11+$e12*tyd12/*\n> */+$d1*wght_t+$d2*wdth_t+$d3*hght_t+$d4*hp_t+$d5*tran_t+$d6*ps_t+$d7*four_t+$d8)\n 55. \n. end\n\n. \n. nl ct_2 nprice\n(obs = 386)\n\nIteration 0:   residual SS =  3793.244\n...\nIteration 51:  residual SS =  11.84729\nIteration 52:  residual SS =  11.84729\n\n      Source |       SS       df       MS            Number of obs =       386\n-------------+------------------------------         F( 46,   339) =   1272.95\n       Model |  2046.39509    46  44.4868497         Prob > F      =    0.0000\n    Residual |  11.8472856   339  .034947745         R-squared     =    0.9942\n-------------+------------------------------         Adj R-squared =    0.9935\n       Total |  2058.24237   385  5.34608409         Root MSE      =  .1869432\n                                                     Res. dev.     = -249.3025\n(ct_2)\n------------------------------------------------------------------------------\n      nprice |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]\n-------------+----------------------------------------------------------------\n          a3 |   129.1587   649.8698     0.20   0.843    -1149.127    1407.444\n          a4 |  -332.9346   853.5884    -0.39   0.697    -2011.931    1346.062\n          a5 |  -39.00799   816.3593    -0.05   0.962    -1644.776     1566.76\n          a6 |  -49.30975   887.7125    -0.06   0.956    -1795.428    1696.809\n          a7 |  -251.5048   1055.969    -0.24   0.812    -2328.582    1825.572\n          a8 |   475.7476   1105.123     0.43   0.667    -1698.014    2649.509\n          a9 |   1305.252   1054.533     1.24   0.217    -769.0007    3379.505\n         a10 |   1500.556   1475.416     1.02   0.310    -1401.567    4402.679\n         a11 |   275.3094    1918.11     0.14   0.886    -3497.586    4048.205\n         a12 |  -369.0768   2256.641    -0.16   0.870    -4807.859    4069.706\n          b2 |  -.0382212   .0476313    -0.80   0.423    -.1319113    .0554688\n          b3 |   .1007584   .1545476     0.65   0.515    -.2032345    .4047514\n          b4 |   .3643006   .1549828     2.35   0.019     .0594514    .6691497\n          b5 |   .3350521   .1522164     2.20   0.028     .0356445    .6344596\n          b6 |    .448507   .1460037     3.07   0.002     .1613198    .7356943\n          b7 |   .5008198   .1605704     3.12   0.002     .1849799    .8166597\n          b8 |   .5229822   .1722726     3.04   0.003     .1841243      .86184\n          b9 |   .3892165   .1802644     2.16   0.032     .0346389    .7437941\n         b10 |   .5894213   .2041663     2.89   0.004     .1878289    .9910137\n         b11 |   .8546564    .199235     4.29   0.000      .462764    1.246549\n         b12 |   1.000789   .1993482     5.02   0.000     .6086733    1.392904\n          c1 |   1.059199   .3598464     2.94   0.003     .3513857    1.767012\n          c2 |   .1615223   .1132255     1.43   0.155    -.0611907    .3842354\n          c3 |  -.6524711   .2018085    -3.23   0.001    -1.049426   -.2555164\n          c4 |   .2672449   .1289842     2.07   0.039     .0135347    .5209551\n          c5 |   .2030882   .0598443     3.39   0.001     .0853753    .3208011\n          c6 |   .2113444   .0828113     2.55   0.011     .0484557    .3742331\n          c7 |   .1550375   .0660018     2.35   0.019     .0252129    .2848621\n          c8 |   8.340437    .114401    72.91   0.000     8.115411    8.565462\n          d1 |   1.111578   .2140655     5.19   0.000     .6905136    1.532641\n          d2 |  -.4348055    .168151    -2.59   0.010    -.7655563   -.1040547\n          d3 |   .0754878   .0932058     0.81   0.419    -.1078468    .2588223\n          d4 |    .559007    .181628     3.08   0.002     .2017472    .9162667\n          d5 |   .1239908   .0427616     2.90   0.004     .0398792    .2081023\n          d6 |  -.0185416   .0827602    -0.22   0.823    -.1813297    .1442466\n          d7 |  -.5680364   .7627409    -0.74   0.457    -2.068338    .9322647\n          d8 |   7.995761   .1883688    42.45   0.000     7.625242     8.36628\n          e2 |         .1          .        .       .            .           .\n          e3 |  -.3274455   .7327471    -0.45   0.655    -1.768749    1.113858\n          e4 |  -.3156744   .7324389    -0.43   0.667    -1.756372    1.125023\n          e5 |  -.5595854   .7452185    -0.75   0.453     -2.02542    .9062493\n          e6 |  -.5473584   .7454929    -0.73   0.463    -2.013733    .9190161\n          e7 |  -.6603122   .7473731    -0.88   0.378    -2.130385    .8097605\n          e8 |  -.4940828   .7382813    -0.67   0.504    -1.946272    .9581066\n          e9 |  -.4857295   .7335855    -0.66   0.508    -1.928682    .9572232\n         e10 |  -.2352299   .7308603    -0.32   0.748    -1.672822    1.202362\n         e11 |  -.1529434   .7360252    -0.21   0.836    -1.600695    1.294808\n         e12 |  -.0194963   .7348633    -0.03   0.979    -1.464963     1.42597\n------------------------------------------------------------------------------\n* Parameter e2 taken as constant term in model & ANOVA table\n (SEs, P values, CIs, and correlations are asymptotic approximations)\n\n. \n. program drop _all\n\n. log close\n      name:  <unnamed>\n       log:  Z:\\home\\pacha\\github\\advanced-international-trade\\first-edition\\Chapt\n> er-8\\system_nocon.log\n  log type:  text\n closed on:  24 Jun 2024, 00:34:17\n----------------------------------------------------------------------------------\n\n. exit\n\nend of do-file\n```\n\n### My code\n\n#### system_nocom.do\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntruck_7990 <- feenstra_88$truck_7990 %>%\n  mutate(ve = 2) %>%\n  rename(\n    wdth_t = wdth, hght_t = hght, wght_t = weight, hp_t = hp, four_t = four,\n    tran_t = tran, ps_t = ps, ac_t = ac\n  )\n\ncar_7990 <- feenstra_88$car_7990 %>%\n  mutate(ve = 1) %>%\n  rename(\n    wdth_c = wdth, hght_c = hght, wght_c = wght, hp_c = hp, four_c = four,\n    tran_c = tran, ps_c = ps, ac_c = ac\n  )\n\ntruck_7990 <- truck_7990 %>%\n  bind_rows(car_7990) %>%\n  mutate(\n    wdth_c = ifelse(is.na(wdth_c), 0, wdth_c),\n    hght_c = ifelse(is.na(hght_c), 0, hght_c),\n    wght_c = ifelse(is.na(wght_c), 0, wght_c),\n    hp_c = ifelse(is.na(hp_c), 0, hp_c),\n    four_c = ifelse(is.na(four_c), 0, four_c),\n    tran_c = ifelse(is.na(tran_c), 0, tran_c),\n    ps_c = ifelse(is.na(ps_c), 0, ps_c),\n    ac_c = ifelse(is.na(ac_c), 0, ac_c),\n    wdth_t = ifelse(is.na(wdth_t), 0, wdth_t),\n    hght_t = ifelse(is.na(hght_t), 0, hght_t),\n    wght_t = ifelse(is.na(wght_t), 0, wght_t),\n    hp_t = ifelse(is.na(hp_t), 0, hp_t),\n    four_t = ifelse(is.na(four_t), 0, four_t),\n    tran_t = ifelse(is.na(tran_t), 0, tran_t),\n    ps_t = ifelse(is.na(ps_t), 0, ps_t),\n    ac_t = ifelse(is.na(ac_t), 0, ac_t)\n  )\n\ntruck_7990 %>%\n  group_by(year) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  mutate(\n    percent = freq / sum(freq) * 100,\n    cum = cumsum(percent)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 4\n    year  freq percent    cum\n   <dbl> <int>   <dbl>  <dbl>\n 1    79    31    7.67   7.67\n 2    80    34    8.42  16.1 \n 3    81    35    8.66  24.8 \n 4    82    35    8.66  33.4 \n 5    83    36    8.91  42.3 \n 6    84    40    9.90  52.2 \n 7    85    43   10.6   62.9 \n 8    86    33    8.17  71.0 \n 9    87    35    8.66  79.7 \n10    88    30    7.43  87.1 \n11    89    26    6.44  93.6 \n12    90    26    6.44 100   \n```\n:::\n\n```{.r .cell-code}\ntruck_7990 <- truck_7990 %>%\n  mutate(yd = as.factor(year - min(year) + 1))\n\ntruck_7990_dummy <- model.matrix(~ yd - 1, data = truck_7990)\n\ntruck_7990 <- truck_7990 %>%\n  bind_cols(as.data.frame(truck_7990_dummy))\n\ntruck_7990 <- truck_7990 %>%\n  mutate(\n    cyd2 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd2\n    ),\n    tyd2 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd2\n    ),\n    cyd3 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd3\n    ),\n    tyd3 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd3\n    ),\n    cyd4 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd4\n    ),\n    tyd4 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd4\n    ),\n    cyd5 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd5\n    ),\n    tyd5 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd5\n    ),\n    cyd6 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd6\n    ),\n    tyd6 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd6\n    ),\n    cyd7 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd7\n    ),\n    tyd7 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd7\n    ),\n    cyd8 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd8\n    ),\n    tyd8 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd8\n    ),\n    cyd9 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd9\n    ),\n    tyd9 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd9\n    ),\n    cyd10 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd10\n    ),\n    tyd10 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd10\n    ),\n    cyd11 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd11\n    ),\n    tyd11 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd11\n    ),\n    cyd12 = case_when(\n      type == \"JT\" ~ 0,\n      TRUE ~ yd12\n    ),\n    tyd12 = case_when(\n      type != \"JT\" ~ 0,\n      TRUE ~ yd12\n    )\n  )\n\ninitial_values <- list(\n  a3 = 1, a4 = 1, a5 = 1, a6 = 1, a7 = 1, a8 = 1, a9 = 1, a10 = 1, a11 = 1,\n  a12 = 1,\n  b2 = 0.1, b3 = 0.1, b4 = 0.1, b5 = 0.1, b6 = 0.1, b7 = 0.1, b8 = 0.1,\n  b9 = 0.1, b10 = 0.1, b11 = 0.1, b12 = 0.1,\n  c1 = 0.1, c2 = 0.1, c3 = 0.1, c4 = 0.1, c5 = 0.1, c6 = 0.1, c7 = 0.1,\n  c8 = 0.1,\n  d1 = 0.1, d2 = 0.1, d3 = 0.1, d4 = 0.1, d5 = 0.1, d6 = 0.1, d7 = 0.1,\n  d8 = 0.1,\n  e2 = 0.1, e3 = 0.1, e4 = 0.1, e5 = 0.1, e6 = 0.1, e7 = 0.1, e8 = 0.1,\n  e9 = 0.1, e10 = 0.1, e11 = 0.1, e12 = 0.1\n)\n\nfit <- nlsLM(\n  price ~ a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * cyd7 +\n    a8 * cyd8 + a9 * cyd9 + a10 * cyd10 + a11 * cyd11 + a12 * cyd12 +\n    exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + b6 * cyd6 + b7 * cyd7 +\n      b8 * cyd8 + b9 * cyd9 + b10 * cyd10 + b11 * cyd11 + b12 * cyd12 +\n      c1 * wght_c + c2 * wdth_c + c3 * hght_c + c4 * hp_c + c5 * tran_c +\n      c6 * ps_c + c7 * ac_c + c8) +\n    exp(e2 * tyd2 + e3 * tyd3 + e4 * tyd4 + e5 * tyd5 + e6 * tyd6 + e7 * tyd7 +\n      e8 * tyd8 + e9 * tyd9 + e10 * tyd10 + e11 * tyd11 + e12 * tyd12 +\n      d1 * wght_t + d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * tran_t +\n      d6 * ps_t + d7 * four_t + d8),\n  data = truck_7990,\n  start = initial_values,\n  # adjust parameters to account to slow convergence\n  control = nls.lm.control(maxiter = 1000, maxfev = 10000)\n)\n\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: price ~ a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * \n    cyd7 + a8 * cyd8 + a9 * cyd9 + a10 * cyd10 + a11 * cyd11 + \n    a12 * cyd12 + exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * \n    cyd5 + b6 * cyd6 + b7 * cyd7 + b8 * cyd8 + b9 * cyd9 + b10 * \n    cyd10 + b11 * cyd11 + b12 * cyd12 + c1 * wght_c + c2 * wdth_c + \n    c3 * hght_c + c4 * hp_c + c5 * tran_c + c6 * ps_c + c7 * \n    ac_c + c8) + exp(e2 * tyd2 + e3 * tyd3 + e4 * tyd4 + e5 * \n    tyd5 + e6 * tyd6 + e7 * tyd7 + e8 * tyd8 + e9 * tyd9 + e10 * \n    tyd10 + e11 * tyd11 + e12 * tyd12 + d1 * wght_t + d2 * wdth_t + \n    d3 * hght_t + d4 * hp_t + d5 * tran_t + d6 * ps_t + d7 * \n    four_t + d8)\n\nParameters:\n      Estimate Std. Error t value Pr(>|t|)    \na3  -232.06287  893.96625  -0.260 0.795332    \na4  -632.87850  914.45900  -0.692 0.489338    \na5  -367.97647  876.38040  -0.420 0.674825    \na6   -48.30074  863.33409  -0.056 0.955416    \na7  -749.19564  928.78692  -0.807 0.420413    \na8   187.75024  939.25918   0.200 0.841679    \na9   333.01836 1009.60725   0.330 0.741708    \na10  243.82112 1132.40125   0.215 0.829646    \na11 -211.61067 1212.77220  -0.174 0.861583    \na12   11.61149 1219.90438   0.010 0.992411    \nb2     0.01556    0.04777   0.326 0.744779    \nb3     0.16598    0.13240   1.254 0.210804    \nb4     0.27475    0.12216   2.249 0.025124 *  \nb5     0.24519    0.11990   2.045 0.041592 *  \nb6     0.26695    0.11691   2.283 0.022994 *  \nb7     0.36389    0.11358   3.204 0.001478 ** \nb8     0.33385    0.11688   2.856 0.004537 ** \nb9     0.40608    0.11768   3.451 0.000626 ***\nb10    0.46226    0.11912   3.881 0.000124 ***\nb11    0.55678    0.11831   4.706 3.62e-06 ***\nb12    0.51644    0.12254   4.214 3.18e-05 ***\nc1     0.47758    0.08994   5.310 1.93e-07 ***\nc2     0.21440    0.04811   4.457 1.12e-05 ***\nc3    -0.39686    0.04746  -8.362 1.41e-15 ***\nc4     0.28379    0.03979   7.132 5.56e-12 ***\nc5     0.06936    0.02017   3.439 0.000653 ***\nc6     0.09921    0.02178   4.555 7.20e-06 ***\nc7     0.16038    0.02163   7.415 8.94e-13 ***\nc8     8.38888    0.20671  40.583  < 2e-16 ***\nd1     0.88011    0.21681   4.059 6.05e-05 ***\nd2     0.47431    0.54808   0.865 0.387397    \nd3    -0.15194    0.16103  -0.944 0.346051    \nd4     0.89964    0.34067   2.641 0.008636 ** \nd5     0.25704    0.11574   2.221 0.026994 *  \nd6     0.02296    0.10258   0.224 0.822986    \nd7     0.64556    0.26226   2.462 0.014309 *  \nd8     3.42341    3.80931   0.899 0.369421    \ne2    -0.75842    1.13213  -0.670 0.503352    \ne3     0.38740    0.33106   1.170 0.242720    \ne4     0.35839    0.31518   1.137 0.256252    \ne5     0.10602    0.32166   0.330 0.741881    \ne6     0.13491    0.32069   0.421 0.674237    \ne7     0.04074    0.30751   0.132 0.894680    \ne8     0.20083    0.31805   0.631 0.528160    \ne9     0.09907    0.31555   0.314 0.753733    \ne10    0.40385    0.36546   1.105 0.269884    \ne11    0.43926    0.34766   1.263 0.207252    \ne12    0.48634    0.35567   1.367 0.172359    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 971.1 on 356 degrees of freedom\n\nNumber of iterations to convergence: 46 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n\n```{.r .cell-code}\nfit_coef <- coef(fit)\n\ntruck_7990 <- truck_7990 %>%\n  mutate(\n    winv = case_when(\n      ve == 1 ~ 1 / exp(fit_coef[\"b2\"] * cyd2 + fit_coef[\"b3\"] * cyd3 +\n        fit_coef[\"b4\"] * cyd4 + fit_coef[\"b5\"] * cyd5 + fit_coef[\"b6\"] * cyd6 +\n        fit_coef[\"b7\"] * cyd7 + fit_coef[\"b8\"] * cyd8 + fit_coef[\"b9\"] * cyd9 +\n        fit_coef[\"b10\"] * cyd10 + fit_coef[\"b11\"] * cyd11 +\n        fit_coef[\"b12\"] * cyd12 + fit_coef[\"c1\"] * wght_c +\n        fit_coef[\"c2\"] * wdth_c + fit_coef[\"c3\"] * hght_c +\n        fit_coef[\"c4\"] * hp_c + fit_coef[\"c5\"] * tran_c +\n        fit_coef[\"c6\"] * ps_c + fit_coef[\"c7\"] * ac_c + fit_coef[\"c8\"]),\n      ve == 2 ~ 1 / exp(fit_coef[\"e2\"] * tyd2 + fit_coef[\"e3\"] * tyd3 +\n        fit_coef[\"e4\"] * tyd4 + fit_coef[\"e5\"] * tyd5 + fit_coef[\"e6\"] * tyd6 +\n        fit_coef[\"e7\"] * tyd7 + fit_coef[\"e8\"] * tyd8 + fit_coef[\"e9\"] * tyd9 +\n        fit_coef[\"e10\"] * tyd10 + fit_coef[\"e11\"] * tyd11 +\n        fit_coef[\"e12\"] * tyd12 + fit_coef[\"d1\"] * wght_t +\n        fit_coef[\"d2\"] * wdth_t + fit_coef[\"d3\"] * hght_t +\n        fit_coef[\"d4\"] * hp_t + fit_coef[\"d5\"] * tran_t +\n        fit_coef[\"d6\"] * ps_t + fit_coef[\"d7\"] * four_t + fit_coef[\"d8\"]),\n    ),\n    nprice = price * winv\n  )\n\nfit2 <- nlsLM(\n  nprice ~winv * (a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + a7 * cyd7 +\n    a8 * cyd8 + a9 * cyd9 + a10 * cyd10 + a11 * cyd11 + a12 * cyd12) +\n    winv * exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + b5 * cyd5 + b6 * cyd6 +\n      b7 * cyd7 + b8 * cyd8 + b9 * cyd9 + b10 * cyd10 + b11 * cyd11 +\n      b12 * cyd12 + c1 * wght_c + c2 * wdth_c + c3 * hght_c + c4 * hp_c +\n      c5 * tran_c + c6 * ps_c + c7 * ac_c + c8) +\n    winv * exp(e2 * tyd2 + e3 * tyd3 + e4 * tyd4 + e5 * tyd5 + e6 * tyd6 +\n      e7 * tyd7 + e8 * tyd8 + e9 * tyd9 + e10 * tyd10 + e11 * tyd11 +\n      e12 * tyd12 + d1 * wght_t + d2 * wdth_t + d3 * hght_t + d4 * hp_t +\n      d5 * tran_t + d6 * ps_t + d7 * four_t + d8),\n  data = truck_7990,\n  start = initial_values,\n  control = nls.lm.control(maxiter = 1000, maxfev = 10000)\n)\n\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFormula: nprice ~ winv * (a3 * cyd3 + a4 * cyd4 + a5 * cyd5 + a6 * cyd6 + \n    a7 * cyd7 + a8 * cyd8 + a9 * cyd9 + a10 * cyd10 + a11 * cyd11 + \n    a12 * cyd12) + winv * exp(b2 * cyd2 + b3 * cyd3 + b4 * cyd4 + \n    b5 * cyd5 + b6 * cyd6 + b7 * cyd7 + b8 * cyd8 + b9 * cyd9 + \n    b10 * cyd10 + b11 * cyd11 + b12 * cyd12 + c1 * wght_c + c2 * \n    wdth_c + c3 * hght_c + c4 * hp_c + c5 * tran_c + c6 * ps_c + \n    c7 * ac_c + c8) + winv * exp(e2 * tyd2 + e3 * tyd3 + e4 * \n    tyd4 + e5 * tyd5 + e6 * tyd6 + e7 * tyd7 + e8 * tyd8 + e9 * \n    tyd9 + e10 * tyd10 + e11 * tyd11 + e12 * tyd12 + d1 * wght_t + \n    d2 * wdth_t + d3 * hght_t + d4 * hp_t + d5 * tran_t + d6 * \n    ps_t + d7 * four_t + d8)\n\nParameters:\n      Estimate Std. Error t value Pr(>|t|)    \na3   6.538e+02  2.721e+02   2.403 0.016762 *  \na4   1.301e+03  2.979e+02   4.365 1.67e-05 ***\na5   1.423e+03  2.842e+02   5.007 8.72e-07 ***\na6   1.938e+03  2.927e+02   6.620 1.32e-10 ***\na7   1.971e+03  2.748e+02   7.172 4.31e-12 ***\na8   2.478e+03  3.573e+02   6.936 1.91e-11 ***\na9   2.834e+03  2.997e+02   9.459  < 2e-16 ***\na10  3.732e+03  5.234e+02   7.130 5.63e-12 ***\na11  4.650e+03  5.096e+02   9.125  < 2e-16 ***\na12  5.719e+03  5.764e+02   9.922  < 2e-16 ***\nb2  -5.319e-03  6.580e-02  -0.081 0.935618    \nb3  -1.247e-02  9.428e-02  -0.132 0.894871    \nb4  -9.225e-02  1.060e-01  -0.870 0.384779    \nb5  -1.341e-01  1.021e-01  -1.314 0.189793    \nb6  -1.575e-01  1.045e-01  -1.507 0.132733    \nb7  -9.892e-02  9.792e-02  -1.010 0.313095    \nb8  -6.148e-02  1.125e-01  -0.546 0.585133    \nb9   6.130e-02  1.017e-01   0.603 0.546933    \nb10 -1.094e-02  1.215e-01  -0.090 0.928310    \nb11 -1.361e-01  1.382e-01  -0.985 0.325535    \nb12 -3.865e-01  1.695e-01  -2.281 0.023133 *  \nc1   4.558e-01  2.257e-01   2.019 0.044207 *  \nc2   5.981e-01  2.570e-01   2.327 0.020522 *  \nc3  -2.753e-01  1.126e-01  -2.444 0.015028 *  \nc4   6.650e-01  1.146e-01   5.804 1.43e-08 ***\nc5   1.549e-01  5.320e-02   2.911 0.003831 ** \nc6   1.789e-01  5.407e-02   3.309 0.001031 ** \nc7   1.813e-01  5.576e-02   3.252 0.001257 ** \nc8   5.149e+00  1.476e+00   3.489 0.000547 ***\nd1   4.063e-01  6.114e-02   6.645 1.14e-10 ***\nd2   1.191e-02  4.744e-02   0.251 0.801843    \nd3   6.573e-02  3.308e-02   1.987 0.047646 *  \nd4   2.526e-01  4.697e-02   5.378 1.37e-07 ***\nd5   3.851e-02  1.365e-02   2.820 0.005068 ** \nd6  -2.048e-02  3.637e-02  -0.563 0.573782    \nd7   2.448e-01  3.168e-02   7.726 1.14e-13 ***\nd8   7.326e+00  3.043e-01  24.072  < 2e-16 ***\ne2   2.753e-02  1.555e-02   1.771 0.077445 .  \ne3   2.568e-01  2.406e-02  10.670  < 2e-16 ***\ne4   2.587e-01  2.458e-02  10.524  < 2e-16 ***\ne5   1.887e-01  2.371e-02   7.960 2.32e-14 ***\ne6   1.903e-01  2.388e-02   7.968 2.21e-14 ***\ne7   1.387e-01  2.473e-02   5.606 4.16e-08 ***\ne8   1.847e-01  2.676e-02   6.901 2.37e-11 ***\ne9   1.956e-01  2.944e-02   6.643 1.15e-10 ***\ne10  2.804e-01  3.795e-02   7.390 1.06e-12 ***\ne11  3.098e-01  3.738e-02   8.289 2.36e-15 ***\ne12  3.654e-01  3.774e-02   9.682  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1613 on 356 degrees of freedom\n\nNumber of iterations to convergence: 28 \nAchieved convergence tolerance: 1.49e-08\n```\n:::\n:::\n",
    "supporting": [
      "chapter8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}